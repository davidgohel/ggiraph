(()=>{var t={146(t,e){"use strict";var n;!function(){var i=e||{}||this||window;void 0===(n=function(){return i}.apply(e,[]))||(t.exports=n),i.default=i;var r="http://www.w3.org/2000/xmlns/",s="http://www.w3.org/2000/svg",o=/url\(["']?(.+?)["']?\)/,a={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},l=function(t){return t instanceof HTMLElement||t instanceof SVGElement},h=function(t){if(!l(t))throw new Error("an HTMLElement or SVGElement is required; got "+t)},u=function(t){return new Promise(function(e,n){l(t)?e(t):n(new Error("an HTMLElement or SVGElement is required; got "+t))})},c=function(t,e,n){var i=t.viewBox&&t.viewBox.baseVal&&t.viewBox.baseVal[n]||null!==e.getAttribute(n)&&!e.getAttribute(n).match(/%$/)&&parseInt(e.getAttribute(n))||t.getBoundingClientRect()[n]||parseInt(e.style[n])||parseInt(window.getComputedStyle(t).getPropertyValue(n));return null==i||isNaN(parseFloat(i))?0:i},f=function(t){for(var e=window.atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),r=new Uint8Array(i),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return new Blob([i],{type:n})},d={},p=null,m=function(t,e){var n=e||{},i=n.selectorRemap,r=n.modifyStyle,s=n.modifyCss,l=n.fonts,h=n.excludeUnusedCss,u=s||function(t,e){return(i?i(t):t)+"{"+(r?r(e):e)+"}\n"},c=[],f=void 0===l,m=l||[];return(p||(p=Array.from(document.styleSheets).map(function(t){try{return{rules:t.cssRules,href:t.href}}catch(e){return console.warn("Stylesheet could not be loaded: "+t.href,e),{}}}))).forEach(function(e){var n=e.rules,i=e.href;n&&Array.from(n).forEach(function(e){if(void 0!==e.style)if(function(t,e){if(e)try{return t.querySelector(e)||t.parentNode&&t.parentNode.querySelector(e)}catch(t){console.warn('Invalid CSS selector "'+e+'"',t)}}(t,e.selectorText))c.push(u(e.selectorText,e.style.cssText));else if(f&&e.cssText.match(/^@font-face/)){var n=function(t,e){var n=t.cssText.match(o),i=n&&n[1]||"";if(i&&!i.match(/^data:/)&&"about:blank"!==i){var r,s,l=i.startsWith("../")?e+"/../"+i:i.startsWith("./")?e+"/."+i:i;return{text:t.cssText,format:(r=l,s=Object.keys(a).filter(function(t){return r.indexOf("."+t)>0}).map(function(t){return a[t]}),s?s[0]:(console.error("Unknown font format for "+r+". Fonts may not be working correctly."),"application/octet-stream")),url:l}}}(e,i);n&&m.push(n)}else h||c.push(e.cssText)})}),function(t){return Promise.all(t.map(function(t){return new Promise(function(e,n){if(d[t.url])return e(d[t.url]);var i=new XMLHttpRequest;i.addEventListener("load",function(){var n=function(t){for(var e="",n=new Uint8Array(t),i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}(i.response),r=t.text.replace(o,'url("data:'+t.format+";base64,"+n+'")')+"\n";d[t.url]=r,e(r)}),i.addEventListener("error",function(n){console.warn("Failed to load font from: "+t.url,n),d[t.url]=null,e(null)}),i.addEventListener("abort",function(n){console.warn("Aborted loading font from: "+t.url,n),e(null)}),i.open("GET",t.url),i.responseType="arraybuffer",i.send()})})).then(function(t){return t.filter(function(t){return t}).join("")})}(m).then(function(t){return c.join("\n")+t})},g=function(){if(!navigator.msSaveOrOpenBlob&&!("download"in document.createElement("a")))return{popup:window.open()}};i.prepareSvg=function(t,e,n){h(t);var i=e||{},o=i.left,a=void 0===o?0:o,l=i.top,u=void 0===l?0:l,f=i.width,d=i.height,p=i.scale,g=void 0===p?1:p,y=i.responsive,v=void 0!==y&&y,w=i.excludeCss,x=void 0!==w&&w;return function(t){return Promise.all(Array.from(t.querySelectorAll("image")).map(function(t){var e,n=t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("href");return n?((e=n)&&0===e.lastIndexOf("http",0)&&-1===e.lastIndexOf(window.location.host)&&(n+=(-1===n.indexOf("?")?"?":"&")+"t="+(new Date).valueOf()),new Promise(function(e,i){var r=document.createElement("canvas"),s=new Image;s.crossOrigin="anonymous",s.src=n,s.onerror=function(){return i(new Error("Could not load "+n))},s.onload=function(){r.width=s.width,r.height=s.height,r.getContext("2d").drawImage(s,0,0),t.setAttributeNS("http://www.w3.org/1999/xlink","href",r.toDataURL("image/png")),e(!0)}})):Promise.resolve(null)}))}(t).then(function(){var i=t.cloneNode(!0);i.style.backgroundColor=(e||{}).backgroundColor||t.style.backgroundColor;var o=function(t,e,n,i){if("svg"===t.tagName)return{width:n||c(t,e,"width"),height:i||c(t,e,"height")};if(t.getBBox){var r=t.getBBox(),s=r.x,o=r.y;return{width:s+r.width,height:o+r.height}}}(t,i,f,d),l=o.width,h=o.height;if("svg"!==t.tagName){if(!t.getBBox)return void console.error("Attempted to render non-SVG element",t);null!=i.getAttribute("transform")&&i.setAttribute("transform",i.getAttribute("transform").replace(/translate\(.*?\)/,""));var p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.appendChild(i),i=p}if(i.setAttribute("version","1.1"),i.setAttribute("viewBox",[a,u,l,h].join(" ")),i.getAttribute("xmlns")||i.setAttributeNS(r,"xmlns",s),i.getAttribute("xmlns:xlink")||i.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),v?(i.removeAttribute("width"),i.removeAttribute("height"),i.setAttribute("preserveAspectRatio","xMinYMin meet")):(i.setAttribute("width",l*g),i.setAttribute("height",h*g)),Array.from(i.querySelectorAll("foreignObject > *")).forEach(function(t){t.setAttributeNS(r,"xmlns","svg"===t.tagName?s:"http://www.w3.org/1999/xhtml")}),!x)return m(t,e).then(function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML="<![CDATA[\n"+t+"\n]]>";var r=document.createElement("defs");r.appendChild(e),i.insertBefore(r,i.firstChild);var s=document.createElement("div");s.appendChild(i);var o=s.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if("function"!=typeof n)return{src:o,width:l,height:h};n(o,l,h)});var y=document.createElement("div");y.appendChild(i);var w=y.innerHTML;if("function"!=typeof n)return{src:w,width:l,height:h};n(w,l,h)})},i.svgAsDataUri=function(t,e,n){return h(t),i.prepareSvg(t,e).then(function(t){var e=t.src,i=t.width,r=t.height,s="data:image/svg+xml;base64,"+window.btoa(decodeURIComponent(encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e).replace(/%([0-9A-F]{2})/g,function(t,e){var n=String.fromCharCode("0x"+e);return"%"===n?"%25":n})));return"function"==typeof n&&n(s,i,r),s})},i.svgAsPngUri=function(t,e,n){h(t);var r=e||{},s=r.encoderType,o=void 0===s?"image/png":s,a=r.encoderOptions,l=void 0===a?.8:a,u=r.canvg,c=function(t){var e=t.src,i=t.width,r=t.height,s=document.createElement("canvas"),a=s.getContext("2d"),h=window.devicePixelRatio||1;s.width=i*h,s.height=r*h,s.style.width=s.width+"px",s.style.height=s.height+"px",a.setTransform(h,0,0,h,0,0),u?u(s,e):a.drawImage(e,0,0);var c=void 0;try{c=s.toDataURL(o,l)}catch(t){if("undefined"!=typeof SecurityError&&t instanceof SecurityError||"SecurityError"===t.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw t}return"function"==typeof n&&n(c,s.width,s.height),Promise.resolve(c)};return u?i.prepareSvg(t,e).then(c):i.svgAsDataUri(t,e).then(function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(c({src:i,width:i.width,height:i.height}))},i.onerror=function(){n("There was an error loading the data URI as an image on the following SVG\n"+window.atob(t.slice(26))+"Open the following link to see browser's diagnosis\n"+t)},i.src=t})})},i.download=function(t,e,n){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(f(e),t);else{var i=document.createElement("a");if("download"in i){i.download=t,i.style.display="none",document.body.appendChild(i);try{var r=f(e),s=URL.createObjectURL(r);i.href=s,i.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(s)})}}catch(t){console.error(t),console.warn("Error while getting object URL. Falling back to string URL."),i.href=e}i.click(),document.body.removeChild(i)}else n&&n.popup&&(n.popup.document.title=t,n.popup.location.replace(e))}},i.saveSvg=function(t,e,n){var r=g();return u(t).then(function(t){return i.svgAsDataUri(t,n||{})}).then(function(t){return i.download(e,t,r)})},i.saveSvgAsPng=function(t,e,n){var r=g();return u(t).then(function(t){return i.svgAsPngUri(t,n||{})}).then(function(t){return i.download(e,t,r)})}}()},297(t,e,n){"use strict";var i=n(383),r=n(519);t.exports=function(t,e){var n=t.length;if(1===n){var s=i(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*n),a=[.1,.1],l=[.1,.1],h=0;i(t[0],e,a),a[0]&&(o[h++]=a[0]);for(var u=1;u<n;++u){i(t[u],e,l);var c=a[1];r(c,l[0],a),a[0]&&(o[h++]=a[0]);var f=l[1],d=a[1],p=f+d,m=d-(p-f);a[1]=p,m&&(o[h++]=m)}return a[1]&&(o[h++]=a[1]),0===h&&(o[h++]=0),o.length=h,o}},383(t){"use strict";t.exports=function(t,n,i){var r=t*n,s=e*t,o=s-(s-t),a=t-o,l=e*n,h=l-(l-n),u=n-h,c=a*u-(r-o*h-a*h-o*u);return i?(i[0]=c,i[1]=r,i):[c,r]};var e=+(Math.pow(2,27)+1)},519(t){"use strict";t.exports=function(t,e,n){var i=t+e,r=i-t,s=e-r,o=t-(i-r);return n?(n[0]=o+s,n[1]=i,n):[o+s,i]}},573(t,e,n){"use strict";var i=n(383),r=n(951),s=n(297),o=n(916);function a(t,e,n,i){return function(n,r,s){var o=t(t(e(r[1],s[0]),e(-s[1],r[0])),t(e(n[1],r[0]),e(-r[1],n[0]))),a=t(e(n[1],s[0]),e(-s[1],n[0])),l=i(o,a);return l[l.length-1]}}function l(t,e,n,i){return function(r,s,o,a){var l=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2])))),h=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2])))),u=i(l,h);return u[u.length-1]}}function h(t,e,n,i){return function(r,s,o,a,l){var h=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),r[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-s[3])))),t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),a[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),-l[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),r[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-s[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-a[3]))))),u=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),r[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-o[3])),t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),a[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-l[3]))),t(t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),r[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),-s[3])),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-l[3])))),c=i(h,u);return c[c.length-1]}}function u(t){return(3===t?a:4===t?l:h)(r,i,s,o)}var c=u(3),f=u(4),d=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),s=(t[0]-n[0])*(e[1]-n[1]),o=r-s;if(r>0){if(s<=0)return o;i=r+s}else{if(!(r<0))return o;if(s>=0)return o;i=-(r+s)}var a=33306690738754716e-32*i;return o>=a||o<=-a?o:c(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],s=e[0]-i[0],o=n[0]-i[0],a=t[1]-i[1],l=e[1]-i[1],h=n[1]-i[1],u=t[2]-i[2],c=e[2]-i[2],d=n[2]-i[2],p=s*h,m=o*l,g=o*a,y=r*h,v=r*l,w=s*a,x=u*(p-m)+c*(g-y)+d*(v-w),_=7771561172376103e-31*((Math.abs(p)+Math.abs(m))*Math.abs(u)+(Math.abs(g)+Math.abs(y))*Math.abs(c)+(Math.abs(v)+Math.abs(w))*Math.abs(d));return x>_||-x>_?x:f(t,e,n,i)}];function p(t){var e=d[t.length];return e||(e=d[t.length]=u(t.length)),e.apply(void 0,t)}function m(t,e,n,i,r,s,o){return function(e,n,a,l,h){switch(arguments.length){case 0:case 1:return 0;case 2:return i(e,n);case 3:return r(e,n,a);case 4:return s(e,n,a,l);case 5:return o(e,n,a,l,h)}for(var u=new Array(arguments.length),c=0;c<arguments.length;++c)u[c]=arguments[c];return t(u)}}!function(){for(;d.length<=5;)d.push(u(d.length));t.exports=m.apply(void 0,[p].concat(d));for(var e=0;e<=5;++e)t.exports[e]=d[e]}()},778(t,e,n){t.exports=function(t,e){for(var n=e[0],r=e[1],s=t.length,o=1,a=s,l=0,h=s-1;l<a;h=l++){var u=t[l],c=t[h],f=u[1],d=c[1];if(d<f){if(d<r&&r<f){if(0===(p=i(u,c,e)))return 0;o^=0<p|0}else if(r===f&&f<t[(l+1)%s][1]){if(0===(p=i(u,c,e)))return 0;o^=0<p|0}}else if(f<d){if(f<r&&r<d){if(0===(p=i(u,c,e)))return 0;o^=p<0|0}else if(r===f&&t[(l+1)%s][1]<f){var p;if(0===(p=i(u,c,e)))return 0;o^=p<0|0}}else if(r===f){var m=Math.min(u[0],c[0]),g=Math.max(u[0],c[0]);if(0===l){for(;h>0;){var y=(h+s-1)%s;if((x=t[y])[1]!==r)break;var v=x[0];m=Math.min(m,v),g=Math.max(g,v),h=y}if(0===h)return m<=n&&n<=g?0:1;a=h+1}for(var w=t[(h+s-1)%s][1];l+1<a;){var x;if((x=t[l+1])[1]!==r)break;v=x[0],m=Math.min(m,v),g=Math.max(g,v),l+=1}if(m<=n&&n<=g)return 0;var _=t[(l+1)%s][1];n<m&&w<r!=_<r&&(o^=1)}}return 2*o-1};var i=n(573)},916(t){"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],-e[0]);var r,s,o=new Array(n+i),a=0,l=0,h=0,u=Math.abs,c=t[l],f=u(c),d=-e[h],p=u(d);f<p?(s=c,(l+=1)<n&&(f=u(c=t[l]))):(s=d,(h+=1)<i&&(p=u(d=-e[h]))),l<n&&f<p||h>=i?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(p=u(d=-e[h])));for(var m,g,y=r+s,v=y-r,w=s-v,x=w,_=y;l<n&&h<i;)f<p?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(p=u(d=-e[h]))),(w=(s=x)-(v=(y=r+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m;for(;l<n;)(w=(s=x)-(v=(y=(r=c)+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m,(l+=1)<n&&(c=t[l]);for(;h<i;)(w=(s=x)-(v=(y=(r=d)+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m,(h+=1)<i&&(d=-e[h]);return x&&(o[a++]=x),_&&(o[a++]=_),a||(o[a++]=0),o.length=a,o}},951(t){"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],e[0]);var r,s,o=new Array(n+i),a=0,l=0,h=0,u=Math.abs,c=t[l],f=u(c),d=e[h],p=u(d);f<p?(s=c,(l+=1)<n&&(f=u(c=t[l]))):(s=d,(h+=1)<i&&(p=u(d=e[h]))),l<n&&f<p||h>=i?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(p=u(d=e[h])));for(var m,g,y=r+s,v=y-r,w=s-v,x=w,_=y;l<n&&h<i;)f<p?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(p=u(d=e[h]))),(w=(s=x)-(v=(y=r+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m;for(;l<n;)(w=(s=x)-(v=(y=(r=c)+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m,(l+=1)<n&&(c=t[l]);for(;h<i;)(w=(s=x)-(v=(y=(r=d)+s)-r))&&(o[a++]=w),x=_-((m=_+y)-(g=m-_))+(y-g),_=m,(h+=1)<i&&(d=e[h]);return x&&(o[a++]=x),_&&(o[a++]=_),a||(o[a++]=0),o.length=a,o}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(){}function e(e){return null==e?t:function(){return this.querySelector(e)}}function i(){return[]}function r(t){return null==t?i:function(){return this.querySelectorAll(t)}}function s(t){return function(){return this.matches(t)}}function o(t){return function(e){return e.matches(t)}}var a=Array.prototype.find;function l(){return this.firstElementChild}var h=Array.prototype.filter;function u(){return Array.from(this.children)}function c(t){return new Array(t.length)}function f(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function d(t,e,n,i,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new f(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function p(t,e,n,i,r,s,o){var a,l,h,u=new Map,c=e.length,d=s.length,p=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(p[a]=h=o.call(l,l.__data__,a,e)+"",u.has(h)?r[a]=l:u.set(h,l));for(a=0;a<d;++a)h=o.call(t,s[a],a,s)+"",(l=u.get(h))?(i[a]=l,l.__data__=s[a],u.delete(h)):n[a]=new f(t,s[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(p[a])===l&&(r[a]=l)}function m(t){return t.__data__}function g(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function y(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}f.prototype={constructor:f,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var v="http://www.w3.org/1999/xhtml";const w={svg:"http://www.w3.org/2000/svg",xhtml:v,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function x(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),w.hasOwnProperty(e)?{space:w[e],local:t}:t}function _(t){return function(){this.removeAttribute(t)}}function b(t){return function(){this.removeAttributeNS(t.space,t.local)}}function M(t,e){return function(){this.setAttribute(t,e)}}function S(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function A(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function k(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function N(t){return function(){this.style.removeProperty(t)}}function I(t,e,n){return function(){this.style.setProperty(t,e,n)}}function T(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function O(t,e){return t.style.getPropertyValue(e)||k(t).getComputedStyle(t,null).getPropertyValue(e)}function z(t){return function(){delete this[t]}}function P(t,e){return function(){this[t]=e}}function V(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function C(t){return t.trim().split(/^|\s+/)}function D(t){return t.classList||new B(t)}function B(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function R(t,e){for(var n=D(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function G(t,e){for(var n=D(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function H(t){return function(){R(this,t)}}function $(t){return function(){G(this,t)}}function L(t,e){return function(){(e.apply(this,arguments)?R:G)(this,t)}}function X(){this.textContent=""}function Y(t){return function(){this.textContent=t}}function q(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function U(){this.innerHTML=""}function j(t){return function(){this.innerHTML=t}}function F(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===v&&e.documentElement.namespaceURI===v?e.createElement(t):e.createElementNS(n,t)}}function Z(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function J(t){var e=x(t);return(e.local?Z:Q)(e)}function tt(){return null}function et(){var t=this.parentNode;t&&t.removeChild(this)}function nt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function it(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rt(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function st(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function ot(t,e,n){var i=k(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function at(t,e){return function(){return ot(this,t,e)}}function lt(t,e){return function(){return ot(this,t,e.apply(this,arguments))}}B.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ht=[null];function ut(t,e){this._groups=t,this._parents=e}function ct(){return new ut([[document.documentElement]],ht)}ut.prototype=ct.prototype={constructor:ut,select:function(t){"function"!=typeof t&&(t=e(t));for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s)for(var o,a,l=n[s],h=l.length,u=r[s]=new Array(h),c=0;c<h;++c)(o=l[c])&&(a=t.call(o,o.__data__,c,l))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new ut(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):r(t);for(var e=this._groups,n=e.length,i=[],s=[],o=0;o<n;++o)for(var a,l=e[o],h=l.length,u=0;u<h;++u)(a=l[u])&&(i.push(t.call(a,a.__data__,u,l)),s.push(a));return new ut(i,s)},selectChild:function(t){return this.select(null==t?l:function(t){return function(){return a.call(this.children,t)}}("function"==typeof t?t:o(t)))},selectChildren:function(t){return this.selectAll(null==t?u:function(t){return function(){return h.call(this.children,t)}}("function"==typeof t?t:o(t)))},filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],l=a.length,h=i[r]=[],u=0;u<l;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&h.push(o);return new ut(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,m);var n,i=e?p:d,r=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),u=0;u<o;++u){var c=r[u],f=s[u],y=f.length,v=g(t.call(c,c&&c.__data__,u,r)),w=v.length,x=l[u]=new Array(w),_=a[u]=new Array(w);i(c,f,x,_,h[u]=new Array(y),v,e);for(var b,M,S=0,E=0;S<w;++S)if(b=x[S]){for(S>=E&&(E=S+1);!(M=_[E])&&++E<w;);b._next=M||null}}return(a=new ut(a,r))._enter=l,a._exit=h,a},enter:function(){return new ut(this._enter||this._groups.map(c),this._parents)},exit:function(){return new ut(this._exit||this._groups.map(c),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,u=n[l],c=i[l],f=u.length,d=a[l]=new Array(f),p=0;p<f;++p)(h=u[p]||c[p])&&(d[p]=h);for(;l<r;++l)a[l]=n[l];return new ut(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=y);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,h=r[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(h[u]=o);h.sort(e)}return new ut(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=x(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?b:_:"function"==typeof e?n.local?A:E:n.local?S:M)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?N:"function"==typeof e?T:I)(t,e,null==n?"":n)):O(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?z:"function"==typeof e?V:P)(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var i=D(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?L:e?H:$)(n,e))},text:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?q:Y)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?F:j)(t)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:J(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,n){var i="function"==typeof t?t:J(t),r=null==n?tt:"function"==typeof n?n:e(n);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(et)},clone:function(t){return this.select(t?it:nt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?st:rt,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(i=0,l=a[h];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?lt:at)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};const ft=ct;var dt={value:()=>{}};function pt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new mt(i)}function mt(t){this._=t}function gt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function yt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=dt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}mt.prototype=pt.prototype={constructor:mt,on:function(t,e){var n,i,r=this._,s=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=s[o]).type)r[n]=yt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=yt(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=s[o]).type)&&(n=gt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new mt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};const vt=pt;var wt,xt,_t=0,bt=0,Mt=0,St=0,Et=0,At=0,kt="object"==typeof performance&&performance.now?performance:Date,Nt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function It(){return Et||(Nt(Tt),Et=kt.now()+At)}function Tt(){Et=0}function Ot(){this._call=this._time=this._next=null}function zt(t,e,n){var i=new Ot;return i.restart(t,e,n),i}function Pt(){Et=(St=kt.now())+At,_t=bt=0;try{!function(){It(),++_t;for(var t,e=wt;e;)(t=Et-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_t}()}finally{_t=0,function(){for(var t,e,n=wt,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:wt=e);xt=t,Ct(i)}(),Et=0}}function Vt(){var t=kt.now(),e=t-St;e>1e3&&(At-=e,St=t)}function Ct(t){_t||(bt&&(bt=clearTimeout(bt)),t-Et>24?(t<1/0&&(bt=setTimeout(Pt,t-kt.now()-At)),Mt&&(Mt=clearInterval(Mt))):(Mt||(St=kt.now(),Mt=setInterval(Vt,1e3)),_t=1,Nt(Pt)))}function Dt(t,e,n){var i=new Ot;return e=null==e?0:+e,i.restart(n=>{i.stop(),t(n+e)},e,n),i}Ot.prototype=zt.prototype={constructor:Ot,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?It():+n)+(null==e?0:+e),this._next||xt===this||(xt?xt._next=this:wt=this,xt=this),this._call=t,this._time=n,Ct()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ct())}};var Bt=vt("start","end","cancel","interrupt"),Rt=[];function Gt(t,e,n,i,r,s){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(l){var h,u,c,f;if(1!==n.state)return a();for(h in r)if((f=r[h]).name===n.name){if(3===f.state)return Dt(s);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[h]):+h<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[h])}if(Dt(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(c=n.tween.length),h=0,u=-1;h<c;++h)(f=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function o(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),s=-1,o=i.length;++s<o;)i[s].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=zt(function(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)},0,n.time)}(t,n,{name:e,index:i,group:r,on:Bt,tween:Rt,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function Ht(t,e){var n=Lt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function $t(t,e){var n=Lt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Lt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Xt(t,e){var n,i,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(n=s[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]):o=!1;o&&delete t.__transition}}function Yt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var qt,Ut=180/Math.PI,jt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ft(t,e,n,i,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*Ut,skewX:Math.atan(l)*Ut,scaleX:o,scaleY:a}}function Wt(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,i,r,s,o,a){if(t!==r||i!==s){var l=o.push("translate(",null,e,null,n);a.push({i:l-4,x:Yt(t,r)},{i:l-2,x:Yt(i,s)})}else(r||s)&&o.push("translate("+r+e+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(r(n)+"rotate(",null,i)-2,x:Yt(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(s.rotate,o.rotate,a,l),function(t,e,n,s){t!==e?s.push({i:n.push(r(n)+"skewX(",null,i)-2,x:Yt(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(s.skewX,o.skewX,a,l),function(t,e,n,i,s,o){if(t!==n||e!==i){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:Yt(t,n)},{i:a-2,x:Yt(e,i)})}else 1===n&&1===i||s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Kt=Wt(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?jt:Ft(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),Qt=Wt(function(t){return null==t?jt:(qt||(qt=document.createElementNS("http://www.w3.org/2000/svg","g")),qt.setAttribute("transform",t),(t=qt.transform.baseVal.consolidate())?Ft((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):jt)},", ",")",")");function Zt(t,e){var n,i;return function(){var r=$t(this,t),s=r.tween;if(s!==n)for(var o=0,a=(i=n=s).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function Jt(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var s=$t(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function te(t,e,n){var i=t._id;return t.each(function(){var t=$t(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return Lt(t,i).value[e]}}function ee(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ne(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ie(){}var re=.7,se=1/re,oe="\\s*([+-]?\\d+)\\s*",ae="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",le="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",he=/^#([0-9a-f]{3,8})$/,ue=new RegExp(`^rgb\\(${oe},${oe},${oe}\\)$`),ce=new RegExp(`^rgb\\(${le},${le},${le}\\)$`),fe=new RegExp(`^rgba\\(${oe},${oe},${oe},${ae}\\)$`),de=new RegExp(`^rgba\\(${le},${le},${le},${ae}\\)$`),pe=new RegExp(`^hsl\\(${ae},${le},${le}\\)$`),me=new RegExp(`^hsla\\(${ae},${le},${le},${ae}\\)$`),ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ye(){return this.rgb().formatHex()}function ve(){return this.rgb().formatRgb()}function we(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=he.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?xe(e):3===n?new Me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?_e(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?_e(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ue.exec(t))?new Me(e[1],e[2],e[3],1):(e=ce.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=fe.exec(t))?_e(e[1],e[2],e[3],e[4]):(e=de.exec(t))?_e(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pe.exec(t))?Ie(e[1],e[2]/100,e[3]/100,1):(e=me.exec(t))?Ie(e[1],e[2]/100,e[3]/100,e[4]):ge.hasOwnProperty(t)?xe(ge[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function xe(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function _e(t,e,n,i){return i<=0&&(t=e=n=NaN),new Me(t,e,n,i)}function be(t,e,n,i){return 1===arguments.length?((r=t)instanceof ie||(r=we(r)),r?new Me((r=r.rgb()).r,r.g,r.b,r.opacity):new Me):new Me(t,e,n,null==i?1:i);var r}function Me(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Se(){return`#${Ne(this.r)}${Ne(this.g)}${Ne(this.b)}`}function Ee(){const t=Ae(this.opacity);return`${1===t?"rgb(":"rgba("}${ke(this.r)}, ${ke(this.g)}, ${ke(this.b)}${1===t?")":`, ${t})`}`}function Ae(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ke(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ne(t){return((t=ke(t))<16?"0":"")+t.toString(16)}function Ie(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Oe(t,e,n,i)}function Te(t){if(t instanceof Oe)return new Oe(t.h,t.s,t.l,t.opacity);if(t instanceof ie||(t=we(t)),!t)return new Oe;if(t instanceof Oe)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Oe(o,a,l,t.opacity)}function Oe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function ze(t){return(t=(t||0)%360)<0?t+360:t}function Pe(t){return Math.max(0,Math.min(1,t||0))}function Ve(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ce(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}ee(ie,we,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ye,formatHex:ye,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Te(this).formatHsl()},formatRgb:ve,toString:ve}),ee(Me,be,ne(ie,{brighter(t){return t=null==t?se:Math.pow(se,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?re:Math.pow(re,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Me(ke(this.r),ke(this.g),ke(this.b),Ae(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Se,formatHex:Se,formatHex8:function(){return`#${Ne(this.r)}${Ne(this.g)}${Ne(this.b)}${Ne(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Ee,toString:Ee})),ee(Oe,function(t,e,n,i){return 1===arguments.length?Te(t):new Oe(t,e,n,null==i?1:i)},ne(ie,{brighter(t){return t=null==t?se:Math.pow(se,t),new Oe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?re:Math.pow(re,t),new Oe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Me(Ve(t>=240?t-240:t+120,r,i),Ve(t,r,i),Ve(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Oe(ze(this.h),Pe(this.s),Pe(this.l),Ae(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ae(this.opacity);return`${1===t?"hsl(":"hsla("}${ze(this.h)}, ${100*Pe(this.s)}%, ${100*Pe(this.l)}%${1===t?")":`, ${t})`}`}}));const De=t=>()=>t;function Be(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):De(isNaN(t)?e:t)}const Re=function t(e){var n=function(t){return 1===(t=+t)?Be:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):De(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=be(t)).r,(e=be(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=Be(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function Ge(t){return function(e){var n,i,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=be(e[n]),s[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return s=t(s),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=s(t),i.g=o(t),i.b=a(t),i+""}}}Ge(function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return Ce((n-i/e)*e,o,r,s,a)}}),Ge(function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],s=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return Ce((n-i/e)*e,r,s,o,a)}});var He=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$e=new RegExp(He.source,"g");function Le(t,e){var n,i,r,s=He.lastIndex=$e.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=He.exec(t))&&(i=$e.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Yt(n,i)})),s=$e.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Xe(t,e){var n;return("number"==typeof e?Yt:e instanceof we?Re:(n=we(e))?(e=n,Re):Le)(t,e)}function Ye(t){return function(){this.removeAttribute(t)}}function qe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ue(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttribute(t);return o===s?null:o===i?r:r=e(i=o,n)}}function je(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===i?r:r=e(i=o,n)}}function Fe(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttribute(t)}}function We(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function Ke(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function Qe(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function Ze(t,e){return function(){Ht(this,t).delay=+e.apply(this,arguments)}}function Je(t,e){return e=+e,function(){Ht(this,t).delay=e}}function tn(t,e){return function(){$t(this,t).duration=+e.apply(this,arguments)}}function en(t,e){return e=+e,function(){$t(this,t).duration=e}}var nn=ft.prototype.constructor;function rn(t){return function(){this.style.removeProperty(t)}}var sn=0;function on(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function an(){return++sn}var ln=ft.prototype;on.prototype=function(t){return ft().transition(t)}.prototype={constructor:on,select:function(t){var n=this._name,i=this._id;"function"!=typeof t&&(t=e(t));for(var r=this._groups,s=r.length,o=new Array(s),a=0;a<s;++a)for(var l,h,u=r[a],c=u.length,f=o[a]=new Array(c),d=0;d<c;++d)(l=u[d])&&(h=t.call(l,l.__data__,d,u))&&("__data__"in l&&(h.__data__=l.__data__),f[d]=h,Gt(f[d],n,i,d,f,Lt(l,i)));return new on(o,this._parents,n,i)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=r(t));for(var i=this._groups,s=i.length,o=[],a=[],l=0;l<s;++l)for(var h,u=i[l],c=u.length,f=0;f<c;++f)if(h=u[f]){for(var d,p=t.call(h,h.__data__,f,u),m=Lt(h,n),g=0,y=p.length;g<y;++g)(d=p[g])&&Gt(d,e,n,g,p,m);o.push(p),a.push(h)}return new on(o,a,e,n)},selectChild:ln.selectChild,selectChildren:ln.selectChildren,filter:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],l=a.length,h=i[r]=[],u=0;u<l;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&h.push(o);return new on(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l,h=e[a],u=n[a],c=h.length,f=o[a]=new Array(c),d=0;d<c;++d)(l=h[d]||u[d])&&(f[d]=l);for(;a<i;++a)o[a]=e[a];return new on(o,this._parents,this._name,this._id)},selection:function(){return new nn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=an(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)if(o=a[h]){var u=Lt(o,e);Gt(o,t,n,h,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new on(i,this._parents,t,n)},call:ln.call,nodes:ln.nodes,node:ln.node,size:ln.size,empty:ln.empty,each:ln.each,on:function(t,e){var n=this._id;return arguments.length<2?Lt(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,s=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Ht:$t;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}(n,t,e))},attr:function(t,e){var n=x(t),i="transform"===n?Qt:Xe;return this.attrTween(t,"function"==typeof e?(n.local?We:Fe)(n,i,te(this,"attr."+t,e)):null==e?(n.local?qe:Ye)(n):(n.local?je:Ue)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=x(t);return this.tween(n,(i.local?Ke:Qe)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Kt:Xe;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var s=O(this,t),o=(this.style.removeProperty(t),O(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}(t,i)).on("end.style."+t,rn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,s;return function(){var o=O(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=O(this,t)),o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a))}}(t,i,te(this,"style."+t,e))).each(function(t,e){var n,i,r,s,o="style."+e,a="end."+o;return function(){var l=$t(this,t),h=l.on,u=null==l.value[o]?s||(s=rn(e)):void 0;h===n&&r===u||(i=(n=h).copy()).on(a,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,s=n+"";return function(){var o=O(this,t);return o===s?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,s,n)),i}return s._value=e,s}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(te(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=Lt(this.node(),n).tween,s=0,o=r.length;s<o;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?Zt:Jt)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ze:Je)(e,t)):Lt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?tn:en)(e,t)):Lt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){$t(this,t).ease=e}}(e,t)):Lt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;$t(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){0===--r&&s()}};n.each(function(){var n=$t(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e}),0===r&&s()})},[Symbol.iterator]:ln[Symbol.iterator]};var hn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function un(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}ft.prototype.interrupt=function(t){return this.each(function(){Xt(this,t)})},ft.prototype.transition=function(t){var e,n;t instanceof on?(e=t._id,t=t._name):(e=an(),(n=hn).time=It(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)(o=a[h])&&Gt(o,t,e,h,a,n||un(o,e));return new on(i,this._parents,t,e)};const{abs:cn,max:fn,min:dn}=Math;function pn(t){return{type:t}}function mn(t){return"string"==typeof t?new ut([[document.querySelector(t)]],[document.documentElement]):new ut([[t]],ht)}function gn(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(pn),["n","s"].map(pn),["n","w","e","s","nw","ne","sw","se"].map(pn);const yn={passive:!1},vn={capture:!0,passive:!1};function wn(t){t.stopImmediatePropagation()}function xn(t){t.preventDefault(),t.stopImmediatePropagation()}function _n(t){var e=t.document.documentElement,n=mn(t).on("dragstart.drag",xn,vn);"onselectstart"in e?n.on("selectstart.drag",xn,vn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function bn(t,e){var n=t.document.documentElement,i=mn(t).on("dragstart.drag",null);e&&(i.on("click.drag",xn,vn),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Mn=t=>()=>t;function Sn(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:o,y:a,dx:l,dy:h,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:u}})}function En(t){return!t.ctrlKey&&!t.button}function An(){return this.parentNode}function kn(t,e){return null==e?{x:t.x,y:t.y}:e}function Nn(){return navigator.maxTouchPoints||"ontouchstart"in this}function In(){var t,e,n,i,r=En,s=An,o=kn,a=Nn,l={},h=vt("start","drag","end"),u=0,c=0;function f(t){t.on("mousedown.drag",d).filter(a).on("touchstart.drag",g).on("touchmove.drag",y,yn).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,a){if(!i&&r.call(this,o,a)){var l=w(this,s.call(this,o,a),o,a,"mouse");l&&(mn(o.view).on("mousemove.drag",p,vn).on("mouseup.drag",m,vn),_n(o.view),wn(o),n=!1,t=o.clientX,e=o.clientY,l("start",o))}}function p(i){if(xn(i),!n){var r=i.clientX-t,s=i.clientY-e;n=r*r+s*s>c}l.mouse("drag",i)}function m(t){mn(t.view).on("mousemove.drag mouseup.drag",null),bn(t.view,n),xn(t),l.mouse("end",t)}function g(t,e){if(r.call(this,t,e)){var n,i,o=t.changedTouches,a=s.call(this,t,e),l=o.length;for(n=0;n<l;++n)(i=w(this,a,t,e,o[n].identifier,o[n]))&&(wn(t),i("start",t,o[n]))}}function y(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=l[i[e].identifier])&&(xn(t),n("drag",t,i[e]))}function v(t){var e,n,r=t.changedTouches,s=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),e=0;e<s;++e)(n=l[r[e].identifier])&&(wn(t),n("end",t,r[e]))}function w(t,e,n,i,r,s){var a,c,d,p=h.copy(),m=gn(s||n,e);if(null!=(d=o.call(t,new Sn("beforestart",{sourceEvent:n,target:f,identifier:r,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),i)))return a=d.x-m[0]||0,c=d.y-m[1]||0,function n(s,o,h){var g,y=m;switch(s){case"start":l[r]=n,g=u++;break;case"end":delete l[r],--u;case"drag":m=gn(h||o,e),g=u}p.call(s,t,new Sn(s,{sourceEvent:o,subject:d,target:f,identifier:r,active:g,x:m[0]+a,y:m[1]+c,dx:m[0]-y[0],dy:m[1]-y[1],dispatch:p}),i)}}return f.filter=function(t){return arguments.length?(r="function"==typeof t?t:Mn(!!t),f):r},f.container=function(t){return arguments.length?(s="function"==typeof t?t:Mn(t),f):s},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:Mn(t),f):o},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Mn(!!t),f):a},f.on=function(){var t=h.on.apply(h,arguments);return t===h?f:t},f.clickDistance=function(t){return arguments.length?(c=(t=+t)*t,f):Math.sqrt(c)},f}function Tn(t){return((t=Math.exp(t))+1/t)/2}Sn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const On=function t(e,n,i){function r(t,r){var s,o,a=t[0],l=t[1],h=t[2],u=r[0],c=r[1],f=r[2],d=u-a,p=c-l,m=d*d+p*p;if(m<1e-12)o=Math.log(f/h)/e,s=function(t){return[a+t*d,l+t*p,h*Math.exp(e*t*o)]};else{var g=Math.sqrt(m),y=(f*f-h*h+i*m)/(2*h*n*g),v=(f*f-h*h-i*m)/(2*f*n*g),w=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-w)/e,s=function(t){var i,r=t*o,s=Tn(w),u=h/(n*g)*(s*(i=e*r+w,((i=Math.exp(2*i))-1)/(i+1))-function(t){return((t=Math.exp(t))-1/t)/2}(w));return[a+u*d,l+u*p,h*s/Tn(e*r+w)]}}return s.duration=1e3*o*e/Math.SQRT2,s}return r.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},r}(Math.SQRT2,2,4),zn=t=>()=>t;function Pn(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Vn(t,e,n){this.k=t,this.x=e,this.y=n}Vn.prototype={constructor:Vn,scale:function(t){return 1===t?this:new Vn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Vn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Cn=new Vn(1,0,0);function Dn(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Cn;return t.__zoom}function Bn(t){t.stopImmediatePropagation()}function Rn(t){t.preventDefault(),t.stopImmediatePropagation()}function Gn(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Hn(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function $n(){return this.__zoom||Cn}function Ln(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Xn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yn(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function qn(){const t=function(){const t=navigator.userAgent;let e,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!==e)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}();return"IE 11"==t||"MSIE"===t.substring(0,4)}Dn.prototype=Vn.prototype;class Un{constructor(t,e,n){this.containerid=t,this.svgid=e,this.clsName=n.clsName,this.position=n.position,this.fixed=n.fixed,this.delay_over=n.delay_over,this.delay_out=n.delay_out,this.tooltips=n.tooltips?n.tooltips:{},this.hidden=Array.isArray(n.hidden)?n.hidden:[n.hidden],this.on=!1}init(t){if(!t.length)return!1;let e=null;e=this.fixed?this.fixed&&this.position.includes("bottom")?mn("#"+this.containerid+" .girafe_container_std").append("div").attr("id",this.svgid+"_toolbar").classed(this.clsName,!0).attr("data-forsvg",this.svgid):mn("#"+this.containerid+" .girafe_container_std").insert("div",":first-child").attr("id",this.svgid+"_toolbar").classed(this.clsName,!0).attr("data-forsvg",this.svgid):mn("#"+this.containerid+" .girafe_container_std").append("div").attr("id",this.svgid+"_toolbar").classed(this.clsName,!0).classed(this.clsName+"-floating",!0).classed(this.clsName+"-floating-"+this.position,!0).attr("data-forsvg",this.svgid),e.classed(this.clsName+"-"+this.position,!0);const n=this,i=t.map(t=>t.getButtons().map(t=>t.block)).flat().filter((t,e,n)=>n.indexOf(t)===e).filter(t=>!n.hidden.includes(t));if(!i.length)return e.remove(),!1;const r={};return i.forEach(function(t){r[t]=e.append("xhtml:div").classed(n.clsName+"-block",!0).classed(n.clsName+"-block-"+t,!0).attr("data-forsvg",n.svgid)}),t.forEach(function(t){t.getButtons().forEach(function(t){if(!n.hidden.includes(t.key)&&!n.hidden.includes(t.block)){const e=t.states;let i=t.key,s=t;t.states&&(i=t.current_state,s=e[i]),n.tooltips[i]&&(s.tooltip=n.tooltips[i]),r[t.block].append("xhtml:a").classed(n.clsName+"-icon",!0).classed(n.clsName+"-icon-"+t.key,!0).classed(s.class,!0).classed(s.unclass,!1).attr("title",s.tooltip).attr("data-forsvg",n.svgid).html(s.icon).datum(e).on("click",t.onclick)}})}),!!e.selectAll("."+this.clsName+"-icon").size()||(e.remove(),!1)}destroy(){const t=mn("#"+this.svgid+"_toolbar");try{t.selectAll("."+this.clsName+"-icon").on("click",null)}catch(t){console.error(t)}t.remove()}clear(t){this.fixed||!this.on||this.isValidTarget(t.relatedTarget)||(this.on=!1,mn("#"+this.containerid).select("."+this.clsName).transition().duration(this.delay_out).style("opacity",0))}isValidTarget(t){return t&&t.getAttribute("data-forsvg")===this.svgid}applyOn(){this.fixed||this.on||(this.on=!0,mn("#"+this.svgid+"_toolbar").transition().duration(this.delay_over).style("opacity",.8))}}class jn{constructor(t,e){this.svgid=t,this.min=e.min,this.max=e.max,this.duration=e.duration,this.tooltips=e.tooltips||{},this.default_on=e.default_on||!1,this.zoomer=null,this.on=!1}init(){return!(this.max<=this.min||(this.zoomer=function(){var t,e,n,i=Gn,r=Hn,s=Yn,o=Ln,a=Xn,l=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],u=250,c=On,f=vt("start","zoom","end"),d=0,p=10;function m(t){t.property("__zoom",$n).on("wheel.zoom",b,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",S).filter(a).on("touchstart.zoom",E).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new Vn(e,t.x,t.y)}function y(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new Vn(t.k,i,r)}function v(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n,i){t.on("start.zoom",function(){x(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(i).end()}).tween("zoom",function(){var t=this,s=arguments,o=x(t,s).event(i),a=r.apply(t,s),l=null==n?v(a):"function"==typeof n?n.apply(t,s):n,h=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=t.__zoom,f="function"==typeof e?e.apply(t,s):e,d=c(u.invert(l).concat(h/u.k),f.invert(l).concat(h/f.k));return function(t){if(1===t)t=f;else{var e=d(t),n=h/e[2];t=new Vn(n,l[0]-e[0]*n,l[1]-e[1]*n)}o.zoom(null,t)}})}function x(t,e,n){return!n&&t.__zooming||new _(t,e)}function _(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function b(t,...e){if(i.apply(this,arguments)){var n=x(this,e).event(t),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,o.apply(this,arguments)))),u=gn(t);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=r.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[u,r.invert(u)],Xt(this),n.start()}Rn(t),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",s(y(g(r,a),n.mouse[0],n.mouse[1]),n.extent,h))}}function M(t,...e){if(!n&&i.apply(this,arguments)){var r=t.currentTarget,o=x(this,e,!0).event(t),a=mn(t.view).on("mousemove.zoom",function(t){if(Rn(t),!o.moved){var e=t.clientX-u,n=t.clientY-c;o.moved=e*e+n*n>d}o.event(t).zoom("mouse",s(y(o.that.__zoom,o.mouse[0]=gn(t,r),o.mouse[1]),o.extent,h))},!0).on("mouseup.zoom",function(t){a.on("mousemove.zoom mouseup.zoom",null),bn(t.view,o.moved),Rn(t),o.event(t).end()},!0),l=gn(t,r),u=t.clientX,c=t.clientY;_n(t.view),Bn(t),o.mouse=[l,this.__zoom.invert(l)],Xt(this),o.start()}}function S(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,o=gn(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(o),l=n.k*(t.shiftKey?.5:2),c=s(y(g(n,l),o,a),r.apply(this,e),h);Rn(t),u>0?mn(this).transition().duration(u).call(w,c,o,t):mn(this).call(m.transform,c,o,t)}}function E(n,...r){if(i.apply(this,arguments)){var s,o,a,l,h=n.touches,u=h.length,c=x(this,r,n.changedTouches.length===u).event(n);for(Bn(n),o=0;o<u;++o)l=[l=gn(a=h[o],this),this.__zoom.invert(l),a.identifier],c.touch0?c.touch1||c.touch0[2]===l[2]||(c.touch1=l,c.taps=0):(c.touch0=l,s=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),s&&(c.taps<2&&(e=l[0],t=setTimeout(function(){t=null},500)),Xt(this),c.start())}}function A(t,...e){if(this.__zooming){var n,i,r,o,a=x(this,e).event(t),l=t.changedTouches,u=l.length;for(Rn(t),n=0;n<u;++n)r=gn(i=l[n],this),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=r);if(i=a.that.__zoom,a.touch1){var c=a.touch0[0],f=a.touch0[1],d=a.touch1[0],p=a.touch1[1],m=(m=d[0]-c[0])*m+(m=d[1]-c[1])*m,v=(v=p[0]-f[0])*v+(v=p[1]-f[1])*v;i=g(i,Math.sqrt(m/v)),r=[(c[0]+d[0])/2,(c[1]+d[1])/2],o=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",s(y(i,r,o),a.extent,h))}}function k(t,...i){if(this.__zooming){var r,s,o=x(this,i).event(t),a=t.changedTouches,l=a.length;for(Bn(t),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<l;++r)s=a[r],o.touch0&&o.touch0[2]===s.identifier?delete o.touch0:o.touch1&&o.touch1[2]===s.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(s=gn(s,this),Math.hypot(e[0]-s[0],e[1]-s[1])<p)){var h=mn(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return m.transform=function(t,e,n,i){var r=t.selection?t.selection():t;r.property("__zoom",$n),t!==r?w(t,e,n,i):r.interrupt().each(function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},m.scaleBy=function(t,e,n,i){m.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n,i)},m.scaleTo=function(t,e,n,i){m.transform(t,function(){var t=r.apply(this,arguments),i=this.__zoom,o=null==n?v(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(o),l="function"==typeof e?e.apply(this,arguments):e;return s(y(g(i,l),o,a),t,h)},n,i)},m.translateBy=function(t,e,n,i){m.transform(t,function(){return s(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),h)},null,i)},m.translateTo=function(t,e,n,i,o){m.transform(t,function(){var t=r.apply(this,arguments),o=this.__zoom,a=null==i?v(t):"function"==typeof i?i.apply(this,arguments):i;return s(Cn.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,h)},i,o)},_.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=mn(this.that).datum();f.call(t,this.that,new Pn(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:f}),e)}},m.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:zn(+t),m):o},m.filter=function(t){return arguments.length?(i="function"==typeof t?t:zn(!!t),m):i},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:zn(!!t),m):a},m.extent=function(t){return arguments.length?(r="function"==typeof t?t:zn([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):r},m.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],m):[l[0],l[1]]},m.translateExtent=function(t){return arguments.length?(h[0][0]=+t[0][0],h[1][0]=+t[1][0],h[0][1]=+t[0][1],h[1][1]=+t[1][1],m):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},m.constrain=function(t){return arguments.length?(s=t,m):s},m.duration=function(t){return arguments.length?(u=+t,m):u},m.interpolate=function(t){return arguments.length?(c=t,m):c},m.on=function(){var t=f.on.apply(f,arguments);return t===f?m:t},m.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,m):Math.sqrt(d)},m.tapDistance=function(t){return arguments.length?(p=+t,m):p},m}().scaleExtent([this.min,this.max]).duration(this.duration),this.on=!1,this.default_on&&setTimeout(()=>{this.zoomOn(),this.updateButtonState()},100),0))}destroy(){this.zoomOff(),this.zoomer=null}getButtons(){const t=this;return[{key:"zoom_onoff",block:"zoom",current_state:"zoom_on",states:{zoom_on:{class:"neutral",unclass:"drop",tooltip:"activate pan/zoom",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/></g></svg>"},zoom_off:{class:"drop",unclass:"neutral",tooltip:"deactivate pan/zoom",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/><line y2='455' x2='0' y1='0' x1='416' stroke-width='30'/></g></svg>"}},onclick:function(e){const n=mn(this);let i,r;t.on?(t.zoomOff(),i=e.zoom_on,r="zoom_on"):(t.zoomOn(),i=e.zoom_off,r="zoom_off");const s=t.tooltips[r]||i.tooltip;n.attr("title",s).classed(i.class,!0).classed(i.unclass,!1).html(i.icon)}},{key:"zoom_rect",block:"zoom",class:"neutral",tooltip:"zoom with rectangle",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/><rect x='126' y='153' width='152' height='116' stroke-width='25' fill='transparent'/></g></svg>",onclick:function(){t.zoomRect()}},{key:"zoom_reset",block:"zoom",class:"neutral",tooltip:"reset pan/zoom",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 512 512'><g><polygon points='274,209.7 337.9,145.9 288,96 416,96 416,224 366.1,174.1 302.3,238 '/><polygon points='274,302.3 337.9,366.1 288,416 416,416 416,288 366.1,337.9 302.3,274'/><polygon points='238,302.3 174.1,366.1 224,416 96,416 96,288 145.9,337.9 209.7,274'/><polygon points='238,209.7 174.1,145.9 224,96 96,96 96,224 145.9,174.1 209.7,238'/></g></svg>",onclick:function(){t.zoomIdentity()}}]}zoomOn(){if(!this.on){this.on=!0;const t=mn("#"+this.svgid+"_rootg");mn("#"+this.svgid).call(this.zoomer.on("start",function(){t.style("cursor","move")}).on("zoom",function(e){t.attr("transform",e.transform)}).on("end",function(){t.style("cursor","auto")}))}}zoomIdentity(){const t=Dn(mn("#"+this.svgid+"_rootg").node());if(1===t.k&&0===t.x&&0===t.y)return;const e=this.on;e||this.zoomOn();const n=this;mn("#"+this.svgid).transition().duration(this.duration).on("end",function(){e||n.zoomOff()}).call(this.zoomer.transform,Cn)}zoomOff(){this.on&&(this.on=!1,mn("#"+this.svgid).on(".zoom",null))}updateButtonState(){const t=mn(".ggiraph-toolbar-icon-zoom_onoff");if(!t.empty()){const e=t.datum();if(e){const n=this.on?e.zoom_off:e.zoom_on,i=this.on?"zoom_off":"zoom_on",r=this.tooltips[i]||n.tooltip;t.attr("title",r).classed(n.class,!0).classed(n.unclass,!1).html(n.icon)}}}zoomRect(){const t=this.on;t||this.zoomOn();const e=mn("#"+this.svgid),n=mn("#"+this.svgid+"_rootg"),i=this,r=function(){let t;const e=new DOMRect,n={start:function(){},draw:function(){},end:function(){}};function i(i){const r=i.append("g").attr("class","dragrect").append("rect");let s,o;const a=In().on("start",function(){s=null,o=null,n.start()}).on("drag",function(t){const i=gn(t,this),a=i[0],l=i[1];s?(o.x=a,o.y=l):(s=new DOMPoint(a,l),o=new DOMPoint(a,l));const h=Math.min(s.x,o.x),u=Math.max(s.x,o.x),c=Math.min(s.y,o.y),f=Math.max(s.y,o.y);e.x=h,e.y=c,e.width=u-h,e.height=f-c,r.attr("x",e.x),r.attr("y",e.y),r.attr("width",e.width),r.attr("height",e.height),n.draw()}).on("end",function(){r.attr("display","none"),n.end()});t.call(a)}return i.on=function(t,e){return arguments.length?1===arguments.length?n[t]:(["start","draw","end"].indexOf(t)>-1&&(n[t]=e),i):n},i.targetArea=function(e){return arguments.length?(t=e,i):t},i.rect=function(){return e},i}(),s=function(){n.style("cursor","zoom-in")},o=function(){try{n.style("cursor","auto"),n.on(".dragstart",null).on(".drag",null).on(".dragend",null),n.selectAll("g.dragrect").remove();const s=r.rect(),o=10;if(s.width>=o&&s.height>=o){const r=s.x+s.width/2,o=s.y+s.height/2,a=n.node().getBBox(),l=a.x+a.width/2,h=a.y+a.height/2,u=a.width/a.height;s.height>s.width?(s.width=s.height*u,s.x=r-s.width/2):(s.height=s.width/u,s.y=o-s.height/2);const c=Math.max(Math.min(a.width/s.width,i.max),i.min);s.width=a.width/c,s.height=a.height/c,s.x=r-s.width/2,s.y=o-s.height/2;const f=(l-r-(a.width-s.width)/2)*c,d=(h-o-(a.height-s.height)/2)*c;e.transition().duration(i.duration).on("end",function(){t||i.zoomOff()}).call(i.zoomer.transform,Cn.translate(f,d).scale(c))}}catch(t){console.error(t)}};try{n.call(r.targetArea(n).on("start",s).on("end",o))}catch(t){console.error(t)}}}function Fn(t){const e=t.ownerDocument,n=e.documentElement,i=e.defaultView;return new window.DOMRect(i.pageXOffset||n.scrollLeft||0,i.pageYOffset||n.scrollTop||0,Math.max(n.clientWidth||0,i.innerWidth||0),Math.max(n.clientHeight||0,i.innerHeight||0))}function Wn(t){const e=new window.DOMMatrix;let n=e,i=t;const r=t.ownerDocument.defaultView||window,s=Fn(t);for(;null!=i&&i!==i.ownerDocument.documentElement;){const t=r.getComputedStyle(i,void 0).transform||"none";n=("none"===t?e:new window.DOMMatrix(t)).multiply(n),i=i.parentNode}const o=t.offsetWidth,a=t.offsetHeight,l=new window.DOMPoint(0,0).matrixTransform(n),h=new window.DOMPoint(o,0).matrixTransform(n),u=new window.DOMPoint(o,a).matrixTransform(n),c=new window.DOMPoint(0,a).matrixTransform(n),f=Math.min(l.x,h.x,u.x,c.x),d=Math.min(l.y,h.y,u.y,c.y),p=t.getBoundingClientRect();return n=e.translate(s.x+p.left-f,s.y+p.top-d,0).multiply(n),n}function Kn(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Qn(t,e,n){if(e.x===n.x&&e.y===n.y)return Kn(t,e);const i=function(t,e){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}(e,n),r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(r<=0)return Kn(t,e);if(r>=1)return Kn(t,n);const s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(s)*Math.sqrt(i)}function Zn(t,e,n,i,r,s,o,a){let l=!1;const h=(a-s)*(n-t)-(o-r)*(i-e);let u=(o-r)*(e-s)-(a-s)*(t-r),c=(n-t)*(e-s)-(i-e)*(t-r);return 0==h?0==u&&(t==n?e<s&&Math.max(e,i)<Math.min(s,a)||s<e&&Math.max(s,a)<Math.min(e,i)||(l=!0):t<r&&Math.max(t,n)<Math.min(r,o)||r<t&&Math.max(r,o)<Math.min(t,n)||(l=!0)):(u/=h,c/=h,u>0&&u<1&&c>0&&c<1&&(l=!0)),l}function Jn(t,e){const n=t.x,i=t.y,r=t.x+t.width,s=t.y+t.height;if(e.find(t=>t.x>=n&&t.x<=r&&t.y>=i&&t.y<=s))return!0;if(1===e.length&&e[0].r){const n=e[0],i=Math.abs(n.x-(t.x+t.width/2)),r=Math.abs(n.y-(t.y+t.height/2));return!(i>t.width/2+n.r)&&(!(r>t.height/2+n.r)&&(i<=t.width/2||(r<=t.height/2||(i-t.width/2^r-t.height/2+2^2)<=(2^n.r))))}if(e.length>1){let t,o;for(t=0;t<e.length;t++)if(o=t+1,o==e.length&&(o=0),Zn(n,i,r,s,e[t].x,e[t].y,e[o].x,e[o].y))return!0}return!1}function ti(t){let e,n,i,r,s,o;const a=new RegExp("([\\d\\.]+) ([\\d\\.]+)","g");if(t instanceof SVGRect||t instanceof DOMRect)return[new DOMPoint(t.x,t.y),new DOMPoint(t.x+t.width,t.y),new DOMPoint(t.x+t.width,t.y+t.height),new DOMPoint(t.x,t.y+t.height)];if(t instanceof SVGRectElement||t instanceof SVGImageElement)return[new DOMPoint(t.x.baseVal.value,t.y.baseVal.value),new DOMPoint(t.x.baseVal.value+t.width.baseVal.value,t.y.baseVal.value),new DOMPoint(t.x.baseVal.value+t.width.baseVal.value,t.y.baseVal.value+t.height.baseVal.value),new DOMPoint(t.x.baseVal.value,t.y.baseVal.value+t.height.baseVal.value)];if(t instanceof SVGCircleElement)return n=new DOMPoint(t.cx.baseVal.value,t.cy.baseVal.value),n.r=t.r.baseVal.value,[n];if(t instanceof SVGLineElement)return e=[new DOMPoint(t.x1.baseVal.value,t.y1.baseVal.value),new DOMPoint(t.x2.baseVal.value,t.y2.baseVal.value)],e.shape="polyline",e;if(t instanceof SVGPolylineElement||t instanceof SVGPolygonElement){for(e=[],i=t.points,r=0;r<i.length;r++)n=i.getItem(r),n instanceof DOMPoint||(n=new DOMPoint(n.x,n.y)),e.push(n);return e.shape=t instanceof SVGPolylineElement?"polyline":"polygon",e}if(t instanceof SVGPathElement){for(e=[],s=t.getAttribute("d");null!==(o=a.exec(s));)e.push(new DOMPoint(parseFloat(o[1]),parseFloat(o[2])));return e}throw"Error in extractPoints: unimplemented object type: "+Object.prototype.toString.call(t)}function ei(t){const e=t.map(t=>t.x),n=t.map(t=>t.y);return{minx:Math.min.apply(null,e),maxx:Math.max.apply(null,e),miny:Math.min.apply(null,n),maxy:Math.max.apply(null,n)}}function ni(t,e){const n=e.createSVGRect();return n.x=t.minx,n.y=t.miny,n.width=t.maxx-t.minx,n.height=t.maxy-t.miny,n}function ii(t,e){return ni(ei(t),e)}function ri(t,e,n,i="#ff000033",r="#ff0000"){let s,o=document.getElementById(n);if(Array.isArray(t)&&1===t.length&&(t=t[0]),o?s=o.localName:(s=t.shape||"polygon",t instanceof SVGPoint||t instanceof DOMPoint?s="circle":(t instanceof SVGRect||t instanceof DOMRect)&&(s="rect"),o=document.createElementNS("http://www.w3.org/2000/svg",s),o.setAttribute("id",n),"polyline"!==s&&o.setAttribute("fill",i),o.setAttribute("stroke",r),o.setAttribute("style","pointer-events: none;"),e.appendChild(o)),"circle"===s)o.setAttribute("cx",t.x),o.setAttribute("cy",t.y),o.setAttribute("r",t.r||"3pt");else if("rect"===s)o.setAttribute("x",t.x),o.setAttribute("y",t.y),o.setAttribute("width",t.width),o.setAttribute("height",t.height);else if("polygon"===s||"polyline"===s){let e="";t.forEach(function(t){e+=t.x+" "+t.y+" "}),o.setAttribute("points",e)}return o}window.DOMPoint=window.DOMPoint||class{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}},window.DOMPoint.prototype.matrixTransform=window.DOMPoint.prototype.matrixTransform||function(t){return(t.is2D||t instanceof SVGMatrix)&&0===this.z&&1===this.w?new DOMPoint(this.x*t.a+this.y*t.c+t.e,this.x*t.b+this.y*t.d+t.f,0,1):new DOMPoint(this.x*t.m11+this.y*t.m21+this.z*t.m31+this.w*t.m41,this.x*t.m12+this.y*t.m22+this.z*t.m32+this.w*t.m42,this.x*t.m13+this.y*t.m23+this.z*t.m33+this.w*t.m43,this.x*t.m14+this.y*t.m24+this.z*t.m34+this.w*t.m44)};{class t{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.width=n,this.height=i}get top(){return this.y}get left(){return this.x}get right(){return this.x+this.width}get bottom(){return this.y+this.height}}for(const e of["top","right","bottom","left"]){const n=Object.getOwnPropertyDescriptor(t.prototype,e);n.enumerable=!0,Object.defineProperty(t.prototype,e,n)}window.DOMRect=window.DOMRect||t}{const t=0,e=1,n=2,i=3,r=4,s=5,o=6,a=7,l=8,h=9,u=10,c=11,f=12,d=13,p=14,m=15,g=t,y=e,v=r,w=s,x=f,_=d,b=Symbol(),M=Symbol(),S=t=>{let e=t.replace(/matrix\(/,"");if(e=e.split(/,/,7),6!==e.length)throw new Error(`Failed to parse ${t}`);return e=e.map(parseFloat),[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]},E=t=>{let e=t.replace(/matrix3d\(/,"");if(e=e.split(/,/,17),16!==e.length)throw new Error(`Failed to parse ${t}`);return e.map(parseFloat)},A=t=>{const e=t.split(/\(/,1)[0];if("matrix"===e)return S(t);if("matrix3d"===e)return E(t);throw new Error(`${e} parsing not implemented`)},k=(t,e,n)=>{if("number"!=typeof n)throw new TypeError("Expected number");t[b][e]=n},N=(t,e,n)=>{if("number"!=typeof n)throw new TypeError("Expected number");e===u||e===m?1!==n&&(t[M]=!1):0!==n&&(t[M]=!1),t[b][e]=n},I=t=>{const e=Object.create(O.prototype);return e.constructor=O,e[M]=!0,e[b]=t,e},T=(t,e)=>{const n=new Float64Array(16);for(let i=0;i<4;i++)for(let r=0;r<4;r++){let s=0;for(let n=0;n<4;n++)s+=t[4*i+n]*e[4*n+r];n[4*i+r]=s}return n};class O{get m11(){return this[b][t]}set m11(e){k(this,t,e)}get m12(){return this[b][e]}set m12(t){k(this,e,t)}get m13(){return this[b][n]}set m13(t){N(this,n,t)}get m14(){return this[b][i]}set m14(t){N(this,i,t)}get m21(){return this[b][r]}set m21(t){k(this,r,t)}get m22(){return this[b][s]}set m22(t){k(this,s,t)}get m23(){return this[b][o]}set m23(t){N(this,o,t)}get m24(){return this[b][a]}set m24(t){N(this,a,t)}get m31(){return this[b][l]}set m31(t){N(this,l,t)}get m32(){return this[b][h]}set m32(t){N(this,h,t)}get m33(){return this[b][u]}set m33(t){N(this,u,t)}get m34(){return this[b][c]}set m34(t){N(this,c,t)}get m41(){return this[b][f]}set m41(t){k(this,f,t)}get m42(){return this[b][d]}set m42(t){k(this,d,t)}get m43(){return this[b][p]}set m43(t){N(this,p,t)}get m44(){return this[b][m]}set m44(t){N(this,m,t)}get a(){return this[b][g]}set a(t){k(this,g,t)}get b(){return this[b][y]}set b(t){k(this,y,t)}get c(){return this[b][v]}set c(t){k(this,v,t)}get d(){return this[b][w]}set d(t){k(this,w,t)}get e(){return this[b][x]}set e(t){k(this,x,t)}get f(){return this[b][_]}set f(t){k(this,_,t)}get is2D(){return this[M]}get isIdentity(){const g=this[b];return 1===g[t]&&0===g[e]&&0===g[n]&&0===g[i]&&0===g[r]&&1===g[s]&&0===g[o]&&0===g[a]&&0===g[l]&&0===g[h]&&1===g[u]&&0===g[c]&&0===g[f]&&0===g[d]&&0===g[p]&&1===g[m]}constructor(S){if(this[M]=!0,this[b]=new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),"string"==typeof S){if(""===S)return;{const t=S.split(/\)\s+/,20).map(A);if(0===t.length)return;S=t[0];for(let e=1;e<t.length;e++)S=T(t[e],S)}}let E=0;if(S&&6===S.length)k(this,g,S[E++]),k(this,y,S[E++]),k(this,v,S[E++]),k(this,w,S[E++]),k(this,x,S[E++]),k(this,_,S[E++]);else if(S&&16===S.length)k(this,t,S[E++]),k(this,e,S[E++]),N(this,n,S[E++]),N(this,i,S[E++]),k(this,r,S[E++]),k(this,s,S[E++]),N(this,o,S[E++]),N(this,a,S[E++]),N(this,l,S[E++]),N(this,h,S[E++]),N(this,u,S[E++]),N(this,c,S[E++]),k(this,f,S[E++]),k(this,d,S[E++]),N(this,p,S[E++]),N(this,m,S[E]);else if(void 0!==S)throw new TypeError("Expected string or array.")}multiply(t){return I(this[b]).multiplySelf(t)}multiplySelf(t){return this[b]=T(t[b],this[b]),t.is2D||(this[M]=!1),this}translate(t,e,n){return I(this[b]).translateSelf(t,e,n)}translateSelf(t=0,e=0,n=0){return this[b]=T([1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1],this[b]),0!==n&&(this[M]=!1),this}scale(t,e,n,i,r,s){return I(this[b]).scaleSelf(t,e,n,i,r,s)}scale3d(t,e,n,i){return I(this[b]).scale3dSelf(t,e,n,i)}scale3dSelf(t,e,n,i){return this.scaleSelf(t,t,t,e,n,i)}scaleSelf(t,e,n,i,r,s){return"number"!=typeof i&&(i=0),"number"!=typeof r&&(r=0),"number"!=typeof s&&(s=0),this.translateSelf(i,r,s),"number"!=typeof t&&(t=1),"number"!=typeof e&&(e=t),"number"!=typeof n&&(n=1),this[b]=T([t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1],this[b]),this.translateSelf(-i,-r,-s),1===n&&0===s||(this[M]=!1),this}inverse(){return I(this[b]).invertSelf()}invertSelf(){if(!this[M])throw new Error("3D matrix inversion is not implemented.");{const t=this[b][g]*this[b][w]-this[b][y]*this[b][v];if(0!==t){const e=new O;return e.a=this[b][w]/t,e.b=-this[b][y]/t,e.c=-this[b][v]/t,e.d=this[b][g]/t,e.e=(this[b][v]*this[b][_]-this[b][w]*this[b][x])/t,e.f=(this[b][y]*this[b][x]-this[b][g]*this[b][_])/t,e}this[M]=!1,this[b]=[NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN]}}}for(const t of["a","b","c","d","e","f","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","is2D","isIdentity"]){const e=Object.getOwnPropertyDescriptor(O.prototype,t);e.enumerable=!0,Object.defineProperty(O.prototype,t,e)}window.DOMMatrix=window.DOMMatrix||O}class si{constructor(t,e){this.svgid=t,this.clsName=e.classPrefix+"_"+this.svgid,this.placement=e.placement,this.opacity=e.opacity,this.offx=e.offx,this.offy=e.offy,this.use_cursor_pos=e.use_cursor_pos,this.use_fill=e.use_fill,this.use_stroke=e.use_stroke,this.delay_over=e.delay_over,this.delay_out=e.delay_out,this.lastTargetId=null}init(){const t=document.getElementById(this.svgid+"_rootg");if(!t.querySelector("*[title]"))return!1;let e;return mn("."+this.clsName).remove(),e="doc"==this.placement?mn("body"):mn(t.ownerSVGElement.parentNode),e.append("xhtml:div").classed(this.clsName,!0).style("position","absolute").style("opacity",0),this.decodingTextarea=document.createElementNS("http://www.w3.org/1999/xhtml","textarea"),!0}destroy(){this.lastTargetId=null,mn("."+this.clsName).remove()}clear(){this.lastTargetId&&(this.lastTargetId=null,mn("div."+this.clsName).transition().duration(this.delay_out).style("opacity",0).on("end",function(){mn(this).style("left","0px").style("top","0px")}))}isValidTarget(t){return t instanceof SVGGraphicsElement&&!(t instanceof SVGSVGElement)&&t.hasAttribute("title")}applyOn(t,e){try{if(this.isValidTarget(t)){const n=new DOMPoint(e.pageX,e.pageY),i=mn("div."+this.clsName);let r;if(t.id===this.lastTargetId)r=this.calculatePosition(i,t,n),i.style("left",r.x+"px").style("top",r.y+"px");else{if(this.lastTargetId=t.id,this.use_fill){let e=t.getAttribute("tooltip_fill");e||(e=t.getAttribute("fill")),e&&i.style("background-color",e)}this.use_stroke&&i.style("border-color",t.getAttribute("stroke")),i.html(this.decodeContent(t.getAttribute("title"))),r=this.calculatePosition(i,t,n),i.style("left",r.x+"px").style("top",r.y+"px").transition().duration(this.delay_over).style("opacity",this.opacity)}return!0}}catch(t){console.error(t)}return!1}decodeContent(t){return this.decodingTextarea.innerHTML=t,this.decodingTextarea.value}calculatePosition(t,e,n){let i,r;const s=e.ownerSVGElement,o=t.node(),a=s.parentNode;if(this.use_cursor_pos){const t=Math.ceil(o.offsetWidth),l=Math.ceil(o.offsetHeight),h=Fn(s);let u=new DOMPoint(h.left,h.top),c=new DOMPoint(h.right,h.bottom);i=n,"doc"!=this.placement&&(r=Wn(a).inverse(),i=i.matrixTransform(r),u=u.matrixTransform(r),c=c.matrixTransform(r));const f=e.getBoundingClientRect(),d=[],p=c.x-(i.x+this.offx),m=i.x-this.offx-u.x;p>=t&&d.push(Math.max(u.x,i.x+this.offx)),m>=t&&d.push(Math.min(c.x-t,i.x-this.offx-t)),d.push(Math.max(u.x,Math.min(c.x,i.x+t/2)-t));const g=[],y=c.y-(i.y+this.offy),v=i.y-this.offy-u.y;y>=l&&g.push(Math.max(u.y,i.y+this.offy)),v>=l&&g.push(Math.min(c.y-l,i.y-this.offy-l)),g.push(Math.max(u.y,Math.min(c.y,i.y+l/2)-l));const w=[];d.forEach(function(e){g.forEach(function(n){w.push(new DOMRect(e,n,t,l))})});let x=w.find(t=>{return n=f,!((e=t).x<=n.x&&e.x+e.width>=n.x+n.width&&e.y<=n.y&&e.y+e.height>=n.y+n.height);var e,n});x||(x=w[0]),i.x=x.x,i.y=x.y}else i=new DOMPoint(this.offx,this.offy),"doc"==this.placement&&(r=Wn(a),i=i.matrixTransform(r));return i}}class oi{constructor(t,e){this.svgid=t,this.clsName=e.classPrefix+"_"+t,this.invClsName=e.invClassPrefix?e.invClassPrefix+"_"+t:null,this.attrName=e.attrName,this.shinyInputId=e.shinyInputId,this.shinyMessageId=e.shinyMessageId,this.nodeIds=[],this.dataHovered=[],this.lastTargetId=null}init(){const t=document.getElementById(this.svgid+"_rootg").querySelectorAll("*["+this.attrName+"]");if(!t.length)return!1;this.nodeIds=Array(t.length);let e=0;t.forEach(function(t){this.nodeIds[e++]=t.id},this);const n=this;return this.shinyMessageId&&Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){"string"==typeof t?n.setHovered([t]):Array.isArray(t)&&n.setHovered(t)}),!0}destroy(){if(this.lastTargetId=null,this.nodeIds=[],this.shinyMessageId)try{Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){})}catch(t){console.error(t)}this.dataHovered=[]}clear(){this.lastTargetId&&(this.lastTargetId=null,this.setHovered([]))}isValidTarget(t){return t instanceof SVGGraphicsElement&&!(t instanceof SVGSVGElement)&&t.hasAttribute(this.attrName)}applyOn(t,e){try{if(this.isValidTarget(t))return t.id!==this.lastTargetId&&(this.lastTargetId=t.id,this.setHovered([t.getAttribute(this.attrName)])),!0}catch(t){console.error(t)}return!1}setHovered(t){this.dataHovered.length===t.length&&this.dataHovered.every(e=>t.includes(e))||(this.dataHovered=t,this.refreshHovered(),this.shinyInputId&&Shiny.onInputChange(this.shinyInputId,this.dataHovered))}refreshHovered(){let t,e,n;this.nodeIds.forEach(function(i){t=document.getElementById(i),t&&(e=this.dataHovered.includes(t.getAttribute(this.attrName)),n=mn(t),n.classed(this.clsName,e),this.invClsName&&(this.dataHovered.length?n.classed(this.invClsName,!e):n.classed(this.invClsName,!1)))},this)}}var ai=n(778),li=n.n(ai);class hi{constructor(t,e){this.svgid=t,this.clsName=e.classPrefix+"_"+t,this.invClsName=e.invClassPrefix?e.invClassPrefix+"_"+t:null,this.attrName=e.attrName,this.shinyInputId=e.shinyInputId,this.shinyMessageId=e.shinyMessageId,this.type=e.type,this.initialSelection=e.selected,this.nodeIds=[],this.dataSelected=[]}init(){if("single"!==this.type&&"multiple"!==this.type)return!1;const t=document.getElementById(this.svgid+"_rootg").querySelectorAll("*["+this.attrName+"]");if(!t.length)return!1;const e=this;this.nodeIds=Array(t.length);let n=0;return t.forEach(function(t){this.nodeIds[n++]=t.id},this),this.shinyMessageId&&Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){"string"==typeof t?e.setSelected([t]):Array.isArray(t)&&e.setSelected(t)}),"string"==typeof this.initialSelection?this.setSelected([this.initialSelection]):Array.isArray(this.initialSelection)&&"multiple"==this.type&&this.setSelected(this.initialSelection),this.initialSelection=null,!0}destroy(){if(this.nodeIds=[],this.dataSelected=[],this.shinyMessageId)try{Shiny.addCustomMessageHandler(this.shinyMessageId,function(t){})}catch(t){console.error(t)}}getButtons(){const t=this;return[{key:"lasso_select",block:"selection",class:"neutral",tooltip:"lasso selection",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>",onclick:function(){t.lasso(!0)}},{key:"lasso_deselect",block:"selection",class:"drop",tooltip:"lasso deselection",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>",onclick:function(){t.lasso(!1)}}]}clear(){this.setSelected([])}isValidTarget(t){return t instanceof SVGGraphicsElement&&!(t instanceof SVGSVGElement)&&t.hasAttribute(this.attrName)}applyOn(t,e){try{if(this.isValidTarget(t)){const e=t.getAttribute(this.attrName);let n=Array.from(this.dataSelected);const i=n.indexOf(e);return"multiple"==this.type?i<0?n.push(e):n.splice(i,1):n=i<0?[e]:[],this.setSelected(n),!0}}catch(t){console.error(t)}return!1}setSelected(t){this.dataSelected.length===t.length&&this.dataSelected.every(e=>t.includes(e))||(this.dataSelected=t,this.refreshSelected(),this.shinyInputId&&Shiny.onInputChange(this.shinyInputId,this.dataSelected))}refreshSelected(){let t,e,n;this.nodeIds.forEach(function(i){t=document.getElementById(i),t&&(e=this.dataSelected.includes(t.getAttribute(this.attrName)),n=mn(t),n.classed(this.clsName,e),this.invClsName&&(this.dataSelected.length?n.classed(this.invClsName,!e):n.classed(this.invClsName,!1)))},this)}lasso(t){const e=mn("#"+this.svgid+"_rootg"),n=this;let i=function(){var t,e=[],n=75,i=!0,r=!1,s=!0,o={start:function(){},draw:function(){},end:function(){}};function a(a){var l,h,u,c,f=a.append("g").attr("class","lasso"),d=f.append("path").attr("class","drawn"),p=f.append("path").attr("class","loop_close"),m=f.append("circle").attr("class","origin"),g=In().on("start",function(){c=[],l="",d.attr("d",null),p.attr("d",null),e.nodes().forEach(function(t){t.__lasso.possible=!1,t.__lasso.selected=!1,t.__lasso.hoverSelect=!1,t.__lasso.loopSelect=!1;var e=t.getBoundingClientRect();t.__lasso.lassoPoint=[Math.round(e.left+e.width/2),Math.round(e.top+e.height/2)]}),s&&e.on("mouseover.lasso",function(){this.__lasso.hoverSelect=!0}),o.start()}).on("drag",function(t){var s,a;"touchmove"===t.sourceEvent.type?(s=t.sourceEvent.touches[0].clientX,a=t.sourceEvent.touches[0].clientY):(s=t.sourceEvent.clientX,a=t.sourceEvent.clientY);var f=gn(t,this),g=f[0],y=f[1];""===l?(l=l+"M "+g+" "+y,h=[s,a],u=[g,y],m.attr("cx",g).attr("cy",y).attr("r",7).attr("display",null)):l=l+" L "+g+" "+y,c.push([s,a]);var v=Math.sqrt(Math.pow(s-h[0],2)+Math.pow(a-h[1],2)),w="M "+g+" "+y+" L "+u[0]+" "+u[1];d.attr("d",l),p.attr("d",w),(r=v<=n)&&i?p.attr("display",null):p.attr("display","none"),e.nodes().forEach(function(t){t.__lasso.loopSelect=!(!r||!i)&&li()(c,t.__lasso.lassoPoint)<1,t.__lasso.possible=t.__lasso.hoverSelect||t.__lasso.loopSelect}),o.draw()}).on("end",function(){e.on("mouseover.lasso",null),e.nodes().forEach(function(t){t.__lasso.selected=t.__lasso.possible,t.__lasso.possible=!1}),d.attr("d",null),p.attr("d",null),m.attr("display","none"),o.end()});t.call(g)}return a.items=function(t){return arguments.length?((e=t).nodes().forEach(function(t){t.__lasso={possible:!1,selected:!1}}),a):e},a.possibleItems=function(){return e.filter(function(){return this.__lasso.possible})},a.selectedItems=function(){return e.filter(function(){return this.__lasso.selected})},a.notPossibleItems=function(){return e.filter(function(){return!this.__lasso.possible})},a.notSelectedItems=function(){return e.filter(function(){return!this.__lasso.selected})},a.closePathDistance=function(t){return arguments.length?(n=t,a):n},a.closePathSelect=function(t){return arguments.length?(i=!0===t,a):i},a.isPathClosed=function(t){return arguments.length?(r=!0===t,a):r},a.hoverSelect=function(t){return arguments.length?(s=!0===t,a):s},a.on=function(t,e){return arguments.length?1===arguments.length?o[t]:(["start","draw","end"].indexOf(t)>-1&&(o[t]=e),a):o},a.targetArea=function(e){return arguments.length?(t=e,a):t},a}();const r=function(){e.style("cursor","crosshair")},s=function(){},o=function(){try{e.style("cursor","auto"),e.on(".dragstart",null).on(".drag",null).on(".dragend",null),e.selectAll("g.lasso").remove();const r=Array.from(n.dataSelected);i.selectedItems().each(function(e,i){const s=this.getAttribute(n.attrName),o=r.indexOf(s);o<0&&t?r.push(s):o>=0&&!t&&r.splice(o,1)}),n.setSelected(r)}catch(t){console.error(t)}};try{i=i.closePathSelect(!0).closePathDistance(100).items(e.selectAll("*["+this.attrName+"]")).targetArea(e).on("start",r).on("draw",s).on("end",o),e.call(i)}catch(t){console.error(t)}}}const ui=["mouseover","mouseout","mousemove","mousedown","wheel","click","nearest"];class ci{constructor(t,e,n){this.svgid=t,this.handlers=e,this.nearestHandler=n}init(){if(this.event_types=ui.filter(t=>"nearest"!==t).filter(t=>this.handlers.get(t)&&this.handlers.get(t).length),!this.event_types.length)return!1;this.handlers.get("nearest")&&this.handlers.get("nearest").length||(this.nearestHandler=null);const t=document.getElementById(this.svgid);let e;return this.event_types.forEach(function(n){e="mousemove"!==n,t.addEventListener(n,this,e)},this),!0}destroy(){try{const t=document.getElementById(this.svgid);this.event_types.forEach(function(e){t.removeEventListener(e,this)},this)}catch(t){console.error(t)}}handleEvent(t){try{const e=t.target;let n=!1,i=null;"mouseout"===t.type?this.handlers.get(t.type).forEach(e=>e.clear(t)):"mouseover"!==t.type||t.buttons?"mousemove"!==t.type||t.buttons?"mousedown"===t.type||"wheel"===t.type?this.handlers.get(t.type).forEach(e=>e.clear(t)):"click"===t.type&&this.svgid!==e.id&&this.handlers.get(t.type).map(n=>n.applyOn(e,t)):(this.svgid!==e.id&&(n=this.handlers.get(t.type).map(n=>n.applyOn(e,t)).find(t=>!!t)),this.nearestHandler&&!n&&(t.fromNearest=!0,i=this.nearestHandler.applyOn(e,t),i?this.handlers.get("nearest").forEach(e=>e.applyOn(i,t)):this.handlers.get("nearest").forEach(e=>e.clear(t)))):this.handlers.get(t.type).forEach(n=>n.applyOn(e,t))}catch(t){console.error(t)}}}class fi{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,e){let n=this.length++;for(;n>0;){const t=n-1>>1,i=this.values[t];if(e>=i)break;this.ids[n]=this.ids[t],this.values[n]=i,n=t}this.ids[n]=t,this.values[n]=e}pop(){if(0===this.length)return;const t=this.ids,e=this.values,n=t[0],i=--this.length;if(i>0){const n=t[i],r=e[i];let s=0;const o=i>>1;for(;s<o;){const n=1+(s<<1),o=n+1,a=n+(+(o<i)&+(e[o]<e[n]));if(e[a]>=r)break;t[s]=t[a],e[s]=e[a],s=a}t[s]=n,e[s]=r}return n}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}const di=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class pi{static from(t,e=0){if(e%8!=0)throw new Error("byteOffset must be 8-byte aligned.");if(!t||void 0===t.byteLength||t.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[n,i]=new Uint8Array(t,e+0,2);if(251!==n)throw new Error("Data does not appear to be in a Flatbush format.");const r=i>>4;if(3!==r)throw new Error(`Got v${r} data when expected v3.`);const s=di[15&i];if(!s)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,e+2,1),[a]=new Uint32Array(t,e+4,1);return new pi(a,o,s,void 0,t,e)}constructor(t,e=16,n=Float64Array,i=ArrayBuffer,r,s=0){if(void 0===t)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.byteOffset=s;let o=t,a=o;this._levelBounds=[4*o];do{o=Math.ceil(o/this.nodeSize),a+=o,this._levelBounds.push(4*a)}while(1!==o);this.ArrayType=n,this.IndexArrayType=a<16384?Uint16Array:Uint32Array;const l=di.indexOf(n),h=4*a*n.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${n}.`);if(r)this.data=r,this._boxes=new n(r,s+8,4*a),this._indices=new this.IndexArrayType(r,s+8+h,a),this._pos=4*a,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{const r=this.data=new i(8+h+a*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new n(r,8,4*a),this._indices=new this.IndexArrayType(r,8+h,a),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(r,0,2).set([251,48+l]),new Uint16Array(r,2,1)[0]=e,new Uint32Array(r,4,1)[0]=t}this._queue=new fi}add(t,e,n=t,i=e){const r=this._pos>>2,s=this._boxes;return this._indices[r]=r,s[this._pos++]=t,s[this._pos++]=e,s[this._pos++]=n,s[this._pos++]=i,t<this.minX&&(this.minX=t),e<this.minY&&(this.minY=e),n>this.maxX&&(this.maxX=n),i>this.maxY&&(this.maxY=i),r}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const t=this._boxes;if(this.numItems<=this.nodeSize)return t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,void(t[this._pos++]=this.maxY);const e=this.maxX-this.minX||1,n=this.maxY-this.minY||1,i=new Uint32Array(this.numItems);for(let r=0,s=0;r<this.numItems;r++){const o=t[s++],a=t[s++],l=t[s++],h=t[s++],u=Math.floor(65535*((o+l)/2-this.minX)/e),c=Math.floor(65535*((a+h)/2-this.minY)/n);i[r]=vi(u,c)}gi(i,t,this._indices,0,this.numItems-1,this.nodeSize);for(let e=0,n=0;e<this._levelBounds.length-1;e++){const i=this._levelBounds[e];for(;n<i;){const e=n;let r=t[n++],s=t[n++],o=t[n++],a=t[n++];for(let e=1;e<this.nodeSize&&n<i;e++)r=Math.min(r,t[n++]),s=Math.min(s,t[n++]),o=Math.max(o,t[n++]),a=Math.max(a,t[n++]);this._indices[this._pos>>2]=e,t[this._pos++]=r,t[this._pos++]=s,t[this._pos++]=o,t[this._pos++]=a}}}search(t,e,n,i,r){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let s=this._boxes.length-4;const o=[],a=[];for(;void 0!==s;){const l=Math.min(s+4*this.nodeSize,mi(s,this._levelBounds));for(let h=s;h<l;h+=4){const l=this._boxes[h];if(n<l)continue;const u=this._boxes[h+1];if(i<u)continue;const c=this._boxes[h+2];if(t>c)continue;const f=this._boxes[h+3];if(e>f)continue;const d=0|this._indices[h>>2];s>=4*this.numItems?o.push(d):(void 0===r||r(d,l,u,c,f))&&a.push(d)}s=o.pop()}return a}neighbors(t,e,n=1/0,i=1/0,r){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let s=this._boxes.length-4;const o=this._queue,a=[],l=i*i;t:for(;void 0!==s;){const i=Math.min(s+4*this.nodeSize,mi(s,this._levelBounds));for(let n=s;n<i;n+=4){const i=0|this._indices[n>>2],a=this._boxes[n],h=this._boxes[n+1],u=this._boxes[n+2],c=this._boxes[n+3],f=t<a?a-t:t>u?t-u:0,d=e<h?h-e:e>c?e-c:0,p=f*f+d*d;p>l||(s>=4*this.numItems?o.push(i<<1,p):(void 0===r||r(i))&&o.push(1+(i<<1),p))}for(;o.length&&1&o.peek();){if(o.peekValue()>l)break t;if(a.push(o.pop()>>1),a.length===n)break t}s=o.length?o.pop()>>1:void 0}return o.clear(),a}}function mi(t,e){let n=0,i=e.length-1;for(;n<i;){const r=n+i>>1;e[r]>t?i=r:n=r+1}return e[n]}function gi(t,e,n,i,r,s){if(Math.floor(i/s)>=Math.floor(r/s))return;const o=t[i],a=t[i+r>>1],l=t[r];let h=l;const u=Math.max(o,a);l>u?h=u:u===o?h=Math.max(a,l):u===a&&(h=Math.max(o,l));let c=i-1,f=r+1;for(;;){do{c++}while(t[c]<h);do{f--}while(t[f]>h);if(c>=f)break;yi(t,e,n,c,f)}gi(t,e,n,i,f,s),gi(t,e,n,f+1,r,s)}function yi(t,e,n,i,r){const s=t[i];t[i]=t[r],t[r]=s;const o=4*i,a=4*r,l=e[o],h=e[o+1],u=e[o+2],c=e[o+3];e[o]=e[a],e[o+1]=e[a+1],e[o+2]=e[a+2],e[o+3]=e[a+3],e[a]=l,e[a+1]=h,e[a+2]=u,e[a+3]=c;const f=n[i];n[i]=n[r],n[r]=f}function vi(t,e){let n=t^e,i=65535^n,r=65535^(t|e),s=t&(65535^e),o=n|i>>1,a=n>>1^n,l=r>>1^i&s>>1^r,h=n&r>>1^s>>1^s;n=o,i=a,r=l,s=h,o=n&n>>2^i&i>>2,a=n&i>>2^i&(n^i)>>2,l^=n&r>>2^i&s>>2,h^=i&r>>2^(n^i)&s>>2,n=o,i=a,r=l,s=h,o=n&n>>4^i&i>>4,a=n&i>>4^i&(n^i)>>4,l^=n&r>>4^i&s>>4,h^=i&r>>4^(n^i)&s>>4,n=o,i=a,r=l,s=h,l^=n&r>>8^i&s>>8,h^=i&r>>8^(n^i)&s>>8,n=l^l>>1,i=h^h>>1;let u=t^e,c=i|65535^(u|n);return u=16711935&(u|u<<8),u=252645135&(u|u<<4),u=858993459&(u|u<<2),u=1431655765&(u|u<<1),c=16711935&(c|c<<8),c=252645135&(c|c<<4),c=858993459&(c|c<<2),c=1431655765&(c|c<<1),(c<<1|u)>>>0}class wi{constructor(t,e,n){this.svgid=t,this.attrNames=e,this.maximum_distance=n,this.spatialIndex=null,this.nodeIds=null,this.debug=!1}init(){if(0===this.maximum_distance)return!1;this.maximum_distance||(this.maximum_distance=1/0);const t=document.getElementById(this.svgid+"_rootg"),e=this.attrNames.map(t=>"*[nearest]["+t+"]").join(", "),n=Array.from(t.querySelectorAll(e)).filter(function(t){return t instanceof SVGCircleElement||t instanceof SVGImageElement||t instanceof SVGLineElement||t instanceof SVGPathElement||t instanceof SVGPolygonElement||t instanceof SVGPolylineElement||t instanceof SVGRectElement||t instanceof SVGTextElement});if(!n.length)return!1;this.spatialIndex=new pi(n.length);const i=t.ownerSVGElement,r=t.getCTM().inverse();let s,o,a,l;const h=new Set;let u,c=0;return this.nodeIds=Array(n.length),n.forEach(function(e){this.nodeIds[c++]=e.id,s=e.getCTM(),o=e.getBBox(),a=ti(o).map(t=>t.matrixTransform(s).matrixTransform(r)),l=ei(a),this.spatialIndex.add(l.minx,l.miny,l.maxx,l.maxy),this.debug&&ri(ni(l,i),i,e.id+"_extent"),e instanceof SVGRectElement||e instanceof SVGImageElement||e instanceof SVGTextElement?(e.gpoints=a,e.gpoints.shape="polygon"):(e.gpoints=ti(e).map(t=>t.matrixTransform(s).matrixTransform(r)),e instanceof SVGCircleElement?(e.gpoints[0].r=e.r.baseVal.value,e.gpoints.shape="circle"):(e instanceof SVGLineElement||e instanceof SVGPolylineElement)&&(e.gpoints.shape="polyline")),this.debug&&ri(e.gpoints,i,e.id+"_points"),e.grect=ni(l,i),u=e.parentElement.getAttribute("clip-path"),u?h.add(u.replace(/url\(#|\)/g,"")):h.add(t.id)},this),this.spatialIndex.finish(),this.nodeIds=n.map(t=>t.id),o=t.getBBox(),s=t.getCTM(),t.gpoints=ti(o).map(t=>t.matrixTransform(s).matrixTransform(r)),this.debug&&ri(t.gpoints,i,t.id+"_rootpoints","none","#00ff00"),0==h.size&&h.add(t.id),h.has(t.id)?this.clips=null:(this.clips=Array.from(h.values()).map(t=>document.getElementById(t)).map(function(t){return Array.from(t.childNodes).filter(t=>t instanceof SVGGraphicsElement).map(function(t){if(s=t.getCTM(),o=t.getBBox(),0===o.width||0===o.height){if(!(t instanceof SVGRectElement))return null;o.x=t.x.baseVal.value,o.y=t.y.baseVal.value,o.width=t.width.baseVal.value,o.height=t.height.baseVal.value}return a=ti(o).map(t=>t.matrixTransform(s).matrixTransform(r)),ni(ei(a),i)}).flat().filter(t=>!!t)}).flat(),this.clips.length||(this.clips=null)),!0}destroy(){this.spatialIndex=null,this.nodeIds=null,this.clips=null}isValidTarget(t){return t instanceof SVGGraphicsElement}applyOn(t,e){try{if(!this.isValidTarget(t))return null;let n=new DOMPoint(e.clientX,e.clientY);const i=document.getElementById(this.svgid),r=document.getElementById(this.svgid+"_rootg");if(i===t&&(t=r),n=n.matrixTransform(t.getScreenCTM().inverse()),this.debug&&ri([n],i,i.id+"_mouse"),this.clips&&!this.clips.find(t=>Jn(t,[n])))return null;let s,o,a=this.spatialIndex.neighbors(n.x,n.y,10,this.maximum_distance).filter((t,e,n)=>n.indexOf(t)===e).map(t=>this.nodeIds[t]).sort().map(t=>document.getElementById(t));if(a.length){let t=Dn(r);t=new DOMMatrix([t.k,0,0,t.k,t.x,t.y]).inverse(),o=r.gpoints.map(e=>e.matrixTransform(t)),s=ii(o,i),this.debug&&ri(s,i,r.id+"_view","none","#00aa00"),a=a.filter(t=>{return e=s,n=t.grect,e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y;var e,n})}if(a.length&&i.checkIntersection){const t=r.getCTM();o=o.map(e=>e.matrixTransform(t)),s=ii(o,i),a=a.filter(t=>i.checkIntersection(t,s))}else a.length&&(a=a.filter(t=>Jn(s,t.gpoints)));let l=null;if(1===a.length)l=a[0];else if(a.length){let t=1/0,e=1/0;a.forEach(function(i){var r,s;i instanceof SVGCircleElement?(r=n,s=i.gpoints[0],t=Kn(r,s)-s.r):t=function(t,e){let n,i,r=1/0;if(e.length>1)for(let s=0;s<e.length;s++)i=s+1,i==e.length&&(i=0),n=Qn(t,e[s],e[i]),n<=r&&(r=n);return r}(n,i.gpoints),t<=e&&t<=this.maximum_distance&&(e=t,l=i)},this)}return l}catch(t){console.error(t)}return null}}var xi,_i=n(146);class bi{constructor(t,e){this.svgid=t,this.pngname=e.pngname+".png"}init(){return"function"==typeof _i.saveSvgAsPng&&"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")}destroy(){this.fonts=null}getButtons(){const t=this;return[{key:"saveaspng",block:"misc",class:"neutral",tooltip:"download png",icon:"<svg xmlns='http://www.w3.org/2000/svg' role='img' viewBox='0 0 512 512'><g><polygon points='95 275 95 415 415 415 415 275 375 275 375 380 135 380 135 275'/><polygon points='220 30 220 250 150 175 150 245 250 345 350 245 350 175 280 250 280 30'/></g></svg>",onclick:function(){t.save_as_png()}}]}save_as_png(){this.fonts||(this.fonts=function(){const t=["woff","ttf","otf","woff2","eot"],e={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject"},n=/(^.+src:\s*)(.+?)(;.*)$/,i=/url\(["']?(.+?)["']?\)(\s*format\(.+?\))?/g,r=new RegExp("url\\([\"\\']?(.+?\\.("+Object.keys(e).join("|")+")(\\?.*?)?)[\"\\']?\\)");function s(s){const o=s.cssText.match(n);if(!o)return;const a=o[1],l=o[2],h=o[3],u=l.match(i);return Array.isArray(u)?u.map(function(t){return function(t,e){const n=t.match(r);let i=n&&n[1]||"";if(i&&!i.match(/^data:/)&&"about:blank"!==i)return i.startsWith("../")?i=e+"/../"+i:i.startsWith("./")&&(i=e+"/."+i),{fmt:n[2],url:i,css:t}}(t,s.href)}).filter(function(t){return!!t}).map(function(e){return e.order=t.indexOf(e.fmt),e}).sort(function(t,e){return t.order-e.order}).slice(0,1).map(function(t){return{text:a+t.css+h,format:e[t.fmt],url:t.url}}).pop():void 0}return Array.from(document.styleSheets).map(function(t){try{return{cssRules:t.cssRules,href:t.href}}catch(e){console.warn("Stylesheet could not be loaded: "+t.href,e)}}).map(function(t){return t&&t.cssRules?Array.from(t.cssRules).filter(function(t){return t.cssText.match(/^@font-face/)}).map(function(e){return{href:t.href,cssText:e.cssText}}):[]}).flat().map(function(t){return s(t)}).filter(function(t){return!!t})}()),(0,_i.saveSvgAsPng)(document.getElementById(this.svgid),this.pngname,{encoderOptions:1,fonts:this.fonts})}}class Mi{constructor(t,e,n){this.svgid=t,this.containerid=e,this.modalId=t+"_fullscreen_modal",this.isOpen=!1,this.boundHandleKeydown=this.handleKeydown.bind(this),this.zindex=n-1||9998,this.originalParent=null,this.originalNextSibling=null,this.originalStyles={}}init(){return!0}destroy(){this.closeModal()}getButtons(){const t=this;return[{key:"fullscreen",block:"misc",class:"neutral",tooltip:"fullscreen",icon:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><g><polygon points='396,396 396,320 436,320 436,456 300,456 300,416 396,416'/><polygon points='116,396 192,396 192,456 56,456 56,320 116,320'/><polygon points='116,116 116,192 56,192 56,56 192,56 192,96 96,96'/><polygon points='396,116 320,116 320,56 456,56 456,192 396,192'/></g></svg>",onclick:function(){t.openModal()}}]}openModal(){if(this.isOpen)return;this.isOpen=!0;const t=document.getElementById(this.svgid);if(!t)return;this.originalParent=t.parentNode,this.originalNextSibling=t.nextSibling,this.originalStyles={width:t.style.width,height:t.style.height,maxWidth:t.style.maxWidth,maxHeight:t.style.maxHeight};const e=mn("body").append("div").attr("id",this.modalId).attr("class","ggiraph-fullscreen-modal").style("z-index",this.zindex),n=e.append("div").attr("class","ggiraph-fullscreen-content");n.append("button").attr("class","ggiraph-fullscreen-close").attr("type","button").attr("aria-label","Close fullscreen").html("&times;").on("click",()=>this.closeModal()),t.style.width="100%",t.style.height="100%",t.style.maxWidth="100%",t.style.maxHeight="100%",n.node().appendChild(t),e.on("click",t=>{t.target===e.node()&&this.closeModal()}),document.addEventListener("keydown",this.boundHandleKeydown)}closeModal(){if(!this.isOpen)return;this.isOpen=!1;const t=document.getElementById(this.svgid);t&&this.originalParent&&(t.style.width=this.originalStyles.width,t.style.height=this.originalStyles.height,t.style.maxWidth=this.originalStyles.maxWidth,t.style.maxHeight=this.originalStyles.maxHeight,this.originalNextSibling?this.originalParent.insertBefore(t,this.originalNextSibling):this.originalParent.appendChild(t)),mn("#"+this.modalId).remove(),document.removeEventListener("keydown",this.boundHandleKeydown),this.originalParent=null,this.originalNextSibling=null,this.originalStyles={}}handleKeydown(t){"Escape"===t.key&&this.closeModal()}}class Si{constructor(t,e){this.containerid=t,this.svgid=null,this.handlers=new Map,this.shinyMode=e}clear(){this.handlers.forEach(t=>t.destroy()),this.handlers.clear(),mn("#"+this.containerid+" style").remove(),mn("#"+this.containerid+" div.girafe_container_std").remove()}setSvgId(t){this.svgid=t}addStyle(t){const e=t.join("\n").replace(/SVGID_/g,this.svgid);mn("#"+this.containerid).append("style").attr("type","text/css").text(e)}addSvg(t,e){mn("#"+this.containerid).append("div").attr("class","girafe_container_std").html(t),e&&function(t){const e=t.indexOf("{"),n=t.substring(e+1,t.lastIndexOf("}")),i=t.substring(0,e),r=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(",");function s(){return Function.apply(this,r)}return r.push(n),s.prototype=Function.prototype,new s}(e)()}IEFixResize(t,e){qn()&&(mn("#"+this.svgid).classed("girafe_svg_ie",!0),mn("#"+this.containerid+" div").classed("girafe_container_ie",!0).style("width",Math.round(100*t)+"%").style("padding-bottom",Math.round(t*e*100)+"%"))}autoScale(t){mn("#"+this.svgid).style("width",t).style("height","100%").style("margin-left","auto").style("margin-right","auto")}fixSize(t,e){mn("#"+this.svgid).attr("preserveAspectRatio","xMidYMin meet"),mn("#"+this.containerid+" .girafe_container_std").style("width","100%"),mn("#"+this.svgid).style("width",Number.parseFloat(t/72).toFixed(3)+"in").style("height",Number.parseFloat(e/72).toFixed(3)+"in")}setSizeLimits(t,e,n,i){mn("#"+this.svgid).style("max-width",t).style("max-height",n).style("min-width",e).style("min-height",i)}removeContainerLimits(){qn()||mn("#"+this.containerid).style("width",null).style("height",null)}setupTooltip(t){try{t.classPrefix="tooltip";const e=new si(this.svgid,t);e.init()&&this.handlers.set("tooltip",e)}catch(t){console.error(t)}}setupHover(t,e,n,i){t.classPrefix="hover_data",t.attrName="data-id",t.shinyInputSuffix="_hovered",t.shinyMessageSuffix="_hovered_set",t.invClassPrefix=e.css.length>0?"hover_inv":null,n.classPrefix="hover_key",n.attrName="key-id",n.shinyInputSuffix="_key_hovered",n.shinyMessageSuffix="_key_hovered_set",i.classPrefix="hover_theme",i.attrName="theme-id",i.shinyInputSuffix="_theme_hovered",i.shinyMessageSuffix="_theme_hovered_set";const r=[t,n,i];let s;try{r.forEach(function(t){t.shinyInputId=this.shinyMode&&t.reactive?this.containerid+t.shinyInputSuffix:null,t.shinyMessageId=this.shinyMode&&t.reactive?this.containerid+t.shinyMessageSuffix:null,s=new oi(this.svgid,t),s.init()&&this.handlers.set(t.classPrefix,s)},this)}catch(t){console.error(t)}try{s=new wi(this.svgid,[t.attrName],t.nearest_distance),s.init()&&this.handlers.set("nearest",s)}catch(t){console.error(t)}}setupSelection(t,e,n,i){t.classPrefix="select_data",t.attrName="data-id",t.shinyInputSuffix="_selected",t.shinyMessageSuffix="_set",t.invClassPrefix=e.css.length>0?"select_inv":null,n.classPrefix="select_key",n.attrName="key-id",n.shinyInputSuffix="_key_selected",n.shinyMessageSuffix="_key_set",i.classPrefix="select_theme",i.attrName="theme-id",i.shinyInputSuffix="_theme_selected",i.shinyMessageSuffix="_theme_set";const r=[t,n,i];let s;try{r.forEach(function(t){!this.shinyMode&&t.only_shiny||(t.shinyInputId=this.shinyMode?this.containerid+t.shinyInputSuffix:null,t.shinyMessageId=this.shinyMode?this.containerid+t.shinyMessageSuffix:null,s=new hi(this.svgid,t),s.init()&&this.handlers.set(t.classPrefix,s))},this)}catch(t){console.error(t)}}setupMouse(){try{const t=new Map;ui.forEach(e=>t.set(e,[])),this.handlers.forEach(function(e){e instanceof si?(t.get("mouseover").push(e),t.get("mouseout").push(e),t.get("mousemove").push(e),t.get("mousedown").push(e),t.get("wheel").push(e),t.get("nearest").push(e)):e instanceof oi?(t.get("mouseover").push(e),t.get("mouseout").push(e),t.get("nearest").push(e)):e instanceof hi?t.get("click").push(e):e instanceof Un&&(t.get("mouseover").push(e),t.get("mouseout").push(e))});const e=new ci(this.svgid,t,this.handlers.get("nearest"));e.init()&&this.handlers.set("mouse",e)}catch(t){console.error(t)}}setupZoom(t,e){try{e&&(t.tooltips=e);const n=new jn(this.svgid,t);n.init()&&this.handlers.set("zoom",n)}catch(t){console.error(t)}}setupToolbar(t,e){let n;try{t.hidden.includes("saveaspng")||(n=new bi(this.svgid,{pngname:t.pngname}),n.init()&&this.handlers.set("png",n))}catch(t){console.error(t)}try{t.hidden.includes("fullscreen")||(n=new Mi(this.svgid,this.containerid,e),n.init()&&this.handlers.set("fullscreen",n))}catch(t){console.error(t)}try{const e=[];this.handlers.forEach(function(t){(t instanceof bi||t instanceof Mi||t instanceof jn||t instanceof hi&&"data-id"==t.attrName&&"multiple"==t.type)&&e.push(t)}),t.clsName="ggiraph-toolbar",n=new Un(this.containerid,this.svgid,t),n.init(e)&&this.handlers.set("toolbar",n)}catch(t){console.error(t)}}}HTMLWidgets.widget({name:"girafe",type:"output",factory:(xi=HTMLWidgets.shinyMode,function(t,e,n){const i=new Si(t.id,xi);return{renderValue:function(e){i.clear(),i.setSvgId(e.uid),i.addStyle([e.settings.tooltip.css,e.settings.select_inv.css,e.settings.select.css,e.settings.select_key.css,e.settings.select_theme.css,e.settings.hover_inv.css,e.settings.hover.css,e.settings.hover_key.css,e.settings.hover_theme.css]),i.addSvg(e.html,e.js);const n=mn("#"+i.svgid).property("viewBox").baseVal;e.settings.sizing.rescale?xi?(i.autoScale("100%"),i.IEFixResize(1,1/e.ratio),i.setSizeLimits(mn(t).style("width"),0,mn(t).style("height"),0)):(i.autoScale(Math.round(100*e.settings.sizing.width)+"%"),i.IEFixResize(e.settings.sizing.width,1/e.ratio),i.setSizeLimits("unset","unset","unset","unset"),i.removeContainerLimits()):(i.fixSize(n.width,n.height),mn(t).style("width",null).style("height",null)),i.setupHover(e.settings.hover,e.settings.hover_inv,e.settings.hover_key,e.settings.hover_theme),i.setupSelection(e.settings.select,e.settings.select_inv,e.settings.select_key,e.settings.select_theme),i.setupZoom(e.settings.zoom,e.settings.toolbar.tooltips),i.setupToolbar(e.settings.toolbar,e.settings.tooltip.zindex),i.setupTooltip(e.settings.tooltip),i.setupMouse()},resize:function(t,e){}}})})})()})();